var emulator={init:function(){memory.memoryInit(),memory.biosInit(),display.canvasInit()},runGame:function(){document.getElementById("middle-content").style.display="none",cpu.timer=window.setInterval(emulator.runFrame,17)},runFrame:function(){for(;144!==display.line;)cpu.ex(memory.readByte(cpu.pc));for(;0!==display.line;)cpu.ex(memory.readByte(cpu.pc))},shrink:function(c){console.log(c),c.style.maxHeight=0}},cpu={timer:0,a:0,b:0,c:0,d:0,e:0,h:0,l:0,f:0,pc:0,pcPrev:0,sp:0,m:0,t:0,ime:0,nop:function(){cpu.m=1,cpu.t=4,cpu.pc+=1},ld_bc_nn:function(){cpu.b=memory.readByte(cpu.pc+2),cpu.c=memory.readByte(cpu.pc+1),cpu.m=3,cpu.t=12,cpu.pc+=3},ld_bc_a:function(){var c=cpu.b;c<<=8,c+=cpu.c,memory.writeByte(cpu.a,c),cpu.m=1,cpu.t=8,cpu.pc+=1},inc_bc:function(){cpu.c++,cpu.c&=255,0===cpu.c&&(cpu.b++,cpu.b&=255),cpu.m=1,cpu.t=8,cpu.pc+=1},inc_b:function(){15==(15&cpu.b)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.b++,cpu.b&=255,0===cpu.b?(cpu.b=0,cpu.setZeroFlag()):cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},dec_b:function(){cpu.b--,cpu.b&=255,0===cpu.b?cpu.setZeroFlag():cpu.resetZeroFlag(),15==(15&cpu.b)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},ld_b_n:function(){cpu.b=memory.readByte(cpu.pc+1),cpu.m=2,cpu.t=8,cpu.pc+=2},rlca:function(){var c=cpu.a>>7&1;1===c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.a=cpu.a<<1&255,cpu.a|=c,cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},ld_nn_sp:function(){memory.writeWord(cpu.sp,memory.readWord(cpu.pc+1)),cpu.m=3,cpu.t=20,cpu.pc+=3},add_hl_bc:function(){var c=cpu.getAddr(cpu.b,cpu.c),p=cpu.getAddr(cpu.h,cpu.l),u=c+p;cpu.l=255&u,cpu.h=u>>8&255,(4095&c)+(4095&p)&4096?cpu.setHalfFlag():cpu.resetHalfFlag(),u>65535?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_a_bc:function(){cpu.a=memory.readByte(cpu.getAddr(cpu.b,cpu.c)),cpu.m=1,cpu.t=8,cpu.pc+=1},dec_bc:function(){var c=cpu.getAddr(cpu.b,cpu.c);c--,cpu.b=c>>8&255,cpu.c=255&c,cpu.m=1,cpu.t=8,cpu.pc+=1},inc_c:function(){15==(15&cpu.c)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.c++,cpu.c&=255,0===cpu.c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},dec_c:function(){cpu.c--,cpu.c&=255,0===cpu.c?cpu.setZeroFlag():cpu.resetZeroFlag(),15==(15&cpu.c)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},ld_c_n:function(){cpu.c=memory.readByte(cpu.pc+1),cpu.m=2,cpu.t=8,cpu.pc+=2},rrca:function(){var c=cpu.a<<7&128;128===c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.a=cpu.a>>1,cpu.a|=c,cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},stop:function(){window.clearInterval(cpu.timer),cpu.m=2,cpu.t=4,cpu.pc+=1},ld_de_nn:function(){cpu.d=memory.readByte(cpu.pc+2),cpu.e=memory.readByte(cpu.pc+1),cpu.m=3,cpu.t=12,cpu.pc+=3},ld_de_a:function(){var c=cpu.getAddr(cpu.d,cpu.e);memory.writeByte(cpu.a,c),cpu.m=1,cpu.t=8,cpu.pc+=1},inc_de:function(){cpu.e++,cpu.e&=255,0===cpu.e&&(cpu.d++,cpu.d&=255),cpu.m=1,cpu.t=8,cpu.pc+=1},inc_d:function(){15==(15&cpu.d)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.d++,cpu.d&=255,0===cpu.d?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},dec_d:function(){cpu.d--,cpu.d&=255,0===cpu.d?cpu.setZeroFlag():cpu.resetZeroFlag(),15==(15&cpu.d)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},ld_d_n:function(){cpu.d=memory.readByte(cpu.pc+1),cpu.m=2,cpu.t=8,cpu.pc+=2},rla:function(){var c=cpu.carryFlag()?1:0;128&cpu.a?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.a=cpu.a<<1,cpu.a+=c,cpu.a&=255,cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},jr_n:function(){cpu.pc+=cpu.signDecode(memory.readByte(cpu.pc+1)),cpu.m=2,cpu.t=12,cpu.pc+=2},add_hl_de:function(){var c=cpu.getAddr(cpu.d,cpu.e),p=cpu.getAddr(cpu.h,cpu.l),u=c+p;cpu.l=255&u,cpu.h=u>>8&255,(4095&c)+(4095&p)&4096?cpu.setHalfFlag():cpu.resetHalfFlag(),u>65535?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_a_de:function(){cpu.a=memory.readByte(cpu.getAddr(cpu.d,cpu.e)),cpu.m=1,cpu.t=8,cpu.pc+=1},dec_de:function(){var c=cpu.getAddr(cpu.d,cpu.e);c--,cpu.d=c>>8&255,cpu.e=255&c,cpu.m=1,cpu.t=8,cpu.pc+=1},inc_e:function(){15==(15&cpu.e)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.e++,cpu.e&=255,0===cpu.e?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},dec_e:function(){cpu.e--,cpu.e&=255,0===cpu.e?cpu.setZeroFlag():cpu.resetZeroFlag(),15==(15&cpu.e)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},ld_e_n:function(){cpu.e=memory.readByte(cpu.pc+1),cpu.m=2,cpu.t=8,cpu.pc+=2},rra:function(){var c=cpu.carryFlag()?128:0;1&cpu.a?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.a=cpu.a>>1,cpu.a+=c,cpu.a&=255,cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},jr_nz_n:function(){cpu.zeroFlag()?(cpu.m=2,cpu.t=8):(cpu.pc+=cpu.signDecode(memory.readByte(cpu.pc+1)),cpu.t=12,cpu.m=2),cpu.pc+=2},ld_hl_nn:function(){cpu.h=memory.readByte(cpu.pc+2),cpu.l=memory.readByte(cpu.pc+1),cpu.m=3,cpu.t=12,cpu.pc+=3},ldi_hl_a:function(){var c=cpu.getAddr(cpu.h,cpu.l);memory.writeByte(cpu.a,c),cpu.l++,cpu.l&=255,0===cpu.l&&(cpu.h++,cpu.h&=255),cpu.m=1,cpu.t=8,cpu.pc+=1},inc_hl:function(){cpu.l++,cpu.l&=255,0===cpu.l&&(cpu.h++,cpu.h&=255),cpu.m=1,cpu.t=8,cpu.pc+=1},inc_h:function(){15==(15&cpu.h)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.h++,cpu.h&=255,0===cpu.h?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},dec_h:function(){cpu.h--,cpu.h&=255,0===cpu.h?cpu.setZeroFlag():cpu.resetZeroFlag(),15==(15&cpu.h)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},ld_h_n:function(){cpu.h=memory.readByte(cpu.pc+1),cpu.m=2,cpu.t=8,cpu.pc+=2},daa:function(){cpu.subFlag()?(cpu.halfFlag()&&(cpu.a-=6,cpu.resetHalfFlag()),cpu.carryFlag()?(cpu.a-=96,cpu.setCarryFlag()):cpu.resetCarryFlag()):(((15&cpu.a)>9||cpu.halfFlag())&&(cpu.a+=6),(4080&cpu.a)>>4>9||cpu.carryFlag()?(cpu.a+=96,cpu.setCarryFlag()):cpu.resetCarryFlag()),cpu.a&=255,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},jr_z_n:function(){cpu.zeroFlag()?(cpu.pc+=cpu.signDecode(memory.readByte(cpu.pc+1)),cpu.t=12,cpu.m=2):(cpu.m=2,cpu.t=8),cpu.pc+=2},add_hl_hl:function(){var c=cpu.getAddr(cpu.h,cpu.l),p=2*c;cpu.l=255&p,cpu.h=p>>8,cpu.h=255&cpu.h,(4095&c)+(4095&c)&4096?cpu.setHalfFlag():cpu.resetHalfFlag(),p>65535?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=8,cpu.pc+=1},ldi_a_hl:function(){cpu.a=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),cpu.l++,cpu.l&=255,0===cpu.l&&(cpu.h++,cpu.h&=255),cpu.m=1,cpu.t=8,cpu.pc+=1},dec_hl:function(){var c=cpu.getAddr(cpu.h,cpu.l);c--,cpu.h=c>>8&255,cpu.l=255&c,cpu.m=1,cpu.t=8,cpu.pc+=1},inc_l:function(){15==(15&cpu.l)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.l++,cpu.l&=255,0===cpu.l?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},dec_l:function(){cpu.l--,cpu.l&=255,0===cpu.l?cpu.setZeroFlag():cpu.resetZeroFlag(),15==(15&cpu.l)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},ld_l_n:function(){cpu.l=memory.readByte(cpu.pc+1),cpu.m=2,cpu.t=8,cpu.pc+=2},cpl:function(){cpu.a=~cpu.a,cpu.a&=255,cpu.setHalfFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},jr_nc_n:function(){cpu.carryFlag()?(cpu.m=2,cpu.t=8):(cpu.pc+=cpu.signDecode(memory.readByte(cpu.pc+1)),cpu.t=12,cpu.m=2),cpu.pc+=2},ld_sp_nn:function(){cpu.sp=memory.readWord(cpu.pc+1),cpu.m=3,cpu.t=12,cpu.pc+=3},ldd_hl_a:function(){var c=cpu.getAddr(cpu.h,cpu.l);memory.writeByte(cpu.a,c);var p=cpu.getAddr(cpu.h,cpu.l);p--,cpu.l=255&p,cpu.h=p>>8&255,cpu.m=1,cpu.t=8,cpu.pc+=1},inc_sp:function(){cpu.sp++,cpu.sp&=65535,cpu.m=1,cpu.t=8,cpu.pc+=1},inc_hl_:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));15==(15&c)?cpu.setHalfFlag():cpu.resetHalfFlag(),c++,c&=255,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=12,cpu.pc+=1},dec_hl_:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c--,c&=255,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),15==(15&c)?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=12,cpu.pc+=1},ld_hl_n:function(){memory.writeByte(memory.readByte(cpu.pc+1),cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=12,cpu.pc+=2},scf:function(){cpu.setCarryFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},jr_c_n:function(){cpu.carryFlag()?(cpu.pc+=cpu.signDecode(memory.readByte(cpu.pc+1)),cpu.t=12,cpu.m=2):(cpu.m=2,cpu.t=8),cpu.pc+=2},add_hl_sp:function(){var c=cpu.getAddr(cpu.h,cpu.l),p=cpu.sp,u=c+p;cpu.l=255&u,cpu.h=u>>8&255,(4095&c)+(4095&p)>4095?cpu.setHalfFlag():cpu.resetHalfFlag(),u>65535?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=8,cpu.pc+=1},ldd_a_hl:function(){var c=cpu.getAddr(cpu.h,cpu.l);cpu.a=memory.readByte(c),c--,cpu.h=c>>8&255,cpu.l=255&c,cpu.m=1,cpu.t=8,cpu.pc+=1},dec_sp:function(){cpu.sp--,cpu.sp&=65535,cpu.m=1,cpu.t=8,cpu.pc+=1},inc_a:function(){15==(15&cpu.a)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.a++,cpu.a&=255,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},dec_a:function(){cpu.a--,cpu.a&=255,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),15==(15&cpu.a)?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},ld_a_n:function(){cpu.a=memory.readByte(cpu.pc+1),cpu.m=2,cpu.t=8,cpu.pc+=2},ccf:function(){cpu.carryFlag()?cpu.resetCarryFlag():cpu.setCarryFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},ld_b_b:function(){cpu.b=cpu.b,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_b_c:function(){cpu.b=cpu.c,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_b_d:function(){cpu.b=cpu.d,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_b_e:function(){cpu.b=cpu.e,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_b_h:function(){cpu.b=cpu.h,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_b_l:function(){cpu.b=cpu.l,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_b_hl:function(){cpu.b=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_b_a:function(){cpu.b=cpu.a,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_c_b:function(){cpu.c=cpu.b,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_c_c:function(){cpu.c=cpu.c,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_c_d:function(){cpu.c=cpu.d,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_c_e:function(){cpu.c=cpu.e,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_c_h:function(){cpu.c=cpu.h,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_c_l:function(){cpu.c=cpu.l,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_c_hl:function(){cpu.c=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_c_a:function(){cpu.c=cpu.a,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_d_b:function(){cpu.d=cpu.b,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_d_c:function(){cpu.d=cpu.c,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_d_d:function(){cpu.d=cpu.d,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_d_e:function(){cpu.d=cpu.e,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_d_h:function(){cpu.d=cpu.h,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_d_l:function(){cpu.d=cpu.l,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_d_hl:function(){cpu.d=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_d_a:function(){cpu.d=cpu.a,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_e_b:function(){cpu.e=cpu.b,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_e_c:function(){cpu.e=cpu.c,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_e_d:function(){cpu.e=cpu.d,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_e_e:function(){cpu.e=cpu.e,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_e_h:function(){cpu.e=cpu.h,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_e_l:function(){cpu.e=cpu.l,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_e_hl:function(){cpu.e=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_e_a:function(){cpu.e=cpu.a,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_h_b:function(){cpu.h=cpu.b,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_h_c:function(){cpu.h=cpu.c,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_h_d:function(){cpu.h=cpu.d,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_h_e:function(){cpu.h=cpu.e,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_h_h:function(){cpu.h=cpu.h,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_h_l:function(){cpu.h=cpu.l,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_h_hl:function(){cpu.h=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_h_a:function(){cpu.h=cpu.a,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_l_b:function(){cpu.l=cpu.b,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_l_c:function(){cpu.l=cpu.c,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_l_d:function(){cpu.l=cpu.d,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_l_e:function(){cpu.l=cpu.e,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_l_h:function(){cpu.l=cpu.h,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_l_l:function(){cpu.l=cpu.l,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_l_hl:function(){cpu.l=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_l_a:function(){cpu.l=cpu.a,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_hl_b:function(){memory.writeByte(cpu.b,cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_hl_c:function(){memory.writeByte(cpu.c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_hl_d:function(){memory.writeByte(cpu.d,cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_hl_e:function(){memory.writeByte(cpu.e,cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_hl_h:function(){memory.writeByte(cpu.h,cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_hl_l:function(){memory.writeByte(cpu.l,cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},halt:function(){if(1===cpu.ime)for(;!(MEMORY[65295]&MEMORY[65535]&31);)timer.step(),display.step();else if(0==(MEMORY[65535]&MEMORY[65295]&31))for(;0==(MEMORY[65535]&MEMORY[65295]&31);)timer.step(),display.step();else cpu.ex(memory.readByte(cpu.pc+1));cpu.pc+=1,cpu.m=1,cpu.t=4},ld_hl_a:function(){memory.writeByte(cpu.a,cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_a_b:function(){cpu.a=cpu.b,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_a_c:function(){cpu.a=cpu.c,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_a_d:function(){cpu.a=cpu.d,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_a_e:function(){cpu.a=cpu.e,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_a_h:function(){cpu.a=cpu.h,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_a_l:function(){cpu.a=cpu.l,cpu.m=1,cpu.t=4,cpu.pc+=1},ld_a_hl:function(){cpu.a=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_a_a:function(){cpu.a=cpu.a,cpu.m=1,cpu.t=4,cpu.pc+=1},add_a_b:function(){var c=cpu.a+cpu.b;c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)+(15&cpu.b)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},add_a_c:function(){var c=cpu.a+cpu.c;c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)+(15&cpu.c)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},add_a_d:function(){var c=cpu.a+cpu.d;c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)+(15&cpu.d)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},add_a_e:function(){var c=cpu.a+cpu.e;c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)+(15&cpu.e)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},add_a_h:function(){var c=cpu.a+cpu.h;c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)+(15&cpu.h)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},add_a_l:function(){var c=cpu.a+cpu.l;c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)+(15&cpu.l)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},add_a_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),p=cpu.a+c;p>255?cpu.setCarryFlag():cpu.resetCarryFlag(),p&=255,(15&cpu.a)+(15&c)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),0===p?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=p,cpu.resetSubFlag(),cpu.m=1,cpu.t=8,cpu.pc+=1},add_a_a:function(){var c=cpu.a+cpu.a;c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)+(15&cpu.a)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},adc_b_a:function(){var c=cpu.a+cpu.b;(15&cpu.a)+(15&cpu.b)+(cpu.f>>4&1)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.carryFlag()&&(c+=1),c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},adc_c_a:function(){var c=cpu.a+cpu.c;(15&cpu.a)+(15&cpu.c)+(cpu.f>>4&1)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.carryFlag()&&(c+=1),c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},adc_d_a:function(){var c=cpu.a+cpu.d;(15&cpu.a)+(15&cpu.d)+(cpu.f>>4&1)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.carryFlag()&&(c+=1),c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},adc_e_a:function(){var c=cpu.a+cpu.e;(15&cpu.a)+(15&cpu.e)+(cpu.f>>4&1)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.carryFlag()&&(c+=1),c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},adc_h_a:function(){var c=cpu.a+cpu.h;(15&cpu.a)+(15&cpu.h)+(cpu.f>>4&1)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.carryFlag()&&(c+=1),c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},adc_l_a:function(){var c=cpu.a+cpu.l;(15&cpu.a)+(15&cpu.l)+(cpu.f>>4&1)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.carryFlag()&&(c+=1),c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=255&c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},adc_hl_a:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),p=cpu.a+c;(15&cpu.a)+(15&c)+(cpu.f>>4&1)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.carryFlag()&&(p+=1),p>255?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(p&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=p,cpu.resetSubFlag(),cpu.m=1,cpu.t=8,cpu.pc+=1},adc_a_a:function(){var c=cpu.a+cpu.a;cpu.carryFlag()&&(c+=1),(15&cpu.a)+(15&cpu.a)+(cpu.f>>4&1)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),c>255?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.resetSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sub_b_a:function(){var c=cpu.a-cpu.b;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)-(15&cpu.b)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sub_c_a:function(){var c=cpu.a-cpu.c;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)-(15&cpu.c)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sub_d_a:function(){var c=cpu.a-cpu.d;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)-(15&cpu.d)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sub_e_a:function(){var c=cpu.a-cpu.e;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)-(15&cpu.e)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sub_h_a:function(){var c=cpu.a-cpu.h;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)-(15&cpu.h)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sub_l_a:function(){var c=cpu.a-cpu.l;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)-(15&cpu.l)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sub_hl_a:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),p=cpu.a-c;p<0?cpu.setCarryFlag():cpu.resetCarryFlag(),p&=255,(15&cpu.a)-(15&c)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),0===p?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=p,cpu.setSubFlag(),cpu.m=1,cpu.t=8,cpu.pc+=1},sub_a_a:function(){var c=cpu.a-cpu.a;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),c&=255,(15&cpu.a)-(15&cpu.a)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sbc_b_a:function(){var c=cpu.a-cpu.b;cpu.carryFlag()&&(c-=1),(15&cpu.a)-(15&cpu.b)-(cpu.f>>4&1)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sbc_c_a:function(){var c=cpu.a-cpu.c;cpu.carryFlag()&&(c-=1),(15&cpu.a)-(15&cpu.c)-(cpu.f>>4&1)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sbc_d_a:function(){var c=cpu.a-cpu.d;cpu.carryFlag()&&(c-=1),(15&cpu.a)-(15&cpu.d)-(cpu.f>>4&1)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sbc_e_a:function(){var c=cpu.a-cpu.e;cpu.carryFlag()&&(c-=1),(15&cpu.a)-(15&cpu.e)-(cpu.f>>4&1)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sbc_h_a:function(){var c=cpu.a-cpu.h;cpu.carryFlag()&&(c-=1),(15&cpu.a)-(15&cpu.h)-(cpu.f>>4&1)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sbc_l_a:function(){var c=cpu.a-cpu.l;cpu.carryFlag()&&(c-=1),(15&cpu.a)-(15&cpu.l)-(cpu.f>>4&1)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},sbc_hl_a:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),p=cpu.a-c;cpu.carryFlag()&&(p-=1),(15&cpu.a)-(15&c)-(cpu.f>>4&1)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),p<0?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(p&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=p,cpu.setSubFlag(),cpu.m=1,cpu.t=8,cpu.pc+=1},sbc_a_a:function(){var c=cpu.a-cpu.a;cpu.carryFlag()&&(c-=1),(15&cpu.a)-(15&cpu.a)-(cpu.f>>4&1)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(c&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=c,cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},and_b:function(){cpu.a&=cpu.b,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},and_c:function(){cpu.a&=cpu.c,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},and_d:function(){cpu.a&=cpu.d,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},and_e:function(){cpu.a&=cpu.e,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},and_h:function(){cpu.a&=cpu.h,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},and_l:function(){cpu.a&=cpu.l,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},and_hl:function(){cpu.a&=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=8,cpu.pc+=1},and_a:function(){cpu.a&=cpu.a,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},xor_b:function(){cpu.a^=cpu.b,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},xor_c:function(){cpu.a^=cpu.c,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},xor_d:function(){cpu.a^=cpu.d,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},xor_e:function(){cpu.a^=cpu.e,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},xor_h:function(){cpu.a^=cpu.h,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},xor_l:function(){cpu.a^=cpu.l,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},xor_hl:function(){cpu.a^=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=8,cpu.pc+=1},xor_a:function(){cpu.a^=cpu.a,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},or_b:function(){cpu.a|=cpu.b,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},or_c:function(){cpu.a|=cpu.c,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},or_d:function(){cpu.a|=cpu.d,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},or_e:function(){cpu.a|=cpu.e,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},or_h:function(){cpu.a|=cpu.h,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},or_l:function(){cpu.a|=cpu.l,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},or_hl:function(){cpu.a|=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=8,cpu.pc+=1},or_a:function(){cpu.a|=cpu.a,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},cp_b:function(){var c=cpu.a-cpu.b;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),(15&cpu.a)<(15&cpu.b)?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},cp_c:function(){var c=cpu.a-cpu.c;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),(15&cpu.a)<(15&cpu.c)?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},cp_d:function(){var c=cpu.a-cpu.d;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),(15&cpu.a)<(15&cpu.d)?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},cp_e:function(){var c=cpu.a-cpu.e;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),(15&cpu.a)<(15&cpu.e)?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},cp_h:function(){var c=cpu.a-cpu.h;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),(15&cpu.a)<(15&cpu.h)?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},cp_l:function(){var c=cpu.a-cpu.l;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),(15&cpu.a)<(15&cpu.l)?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},cp_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),p=cpu.a-c;p<0?cpu.setCarryFlag():cpu.resetCarryFlag(),(15&cpu.a)<(15&c)?cpu.setHalfFlag():cpu.resetHalfFlag(),0===p?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=8,cpu.pc+=1},cp_a:function(){var c=cpu.a-cpu.a;c<0?cpu.setCarryFlag():cpu.resetCarryFlag(),(15&cpu.a)<(15&cpu.a)?cpu.setHalfFlag():cpu.resetHalfFlag(),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.setSubFlag(),cpu.m=1,cpu.t=4,cpu.pc+=1},ret_nz:function(){cpu.zeroFlag()?(cpu.t=8,cpu.m=1,cpu.pc+=1):(cpu.pc=memory.readWord(cpu.sp),cpu.sp+=2,cpu.t=20,cpu.m=1)},pop_bc:function(){cpu.c=memory.readByte(cpu.sp),cpu.b=memory.readByte(cpu.sp+1),cpu.sp+=2,cpu.m=1,cpu.t=12,cpu.pc+=1},jp_nz_nn:function(){cpu.zeroFlag()?(cpu.t=12,cpu.m=3,cpu.pc+=3):(cpu.pc=memory.readWord(cpu.pc+1),cpu.t=16,cpu.m=3)},jp_nn:function(){cpu.pc=memory.readWord(cpu.pc+1),cpu.m=3,cpu.t=16},call_nz_nn:function(){cpu.zeroFlag()?(cpu.t=12,cpu.m=3,cpu.pc+=3):(cpu.sp-=2,memory.writeWord(cpu.pc+3,cpu.sp),cpu.pc=memory.readWord(cpu.pc+1),cpu.t=24,cpu.m=3)},push_bc:function(){cpu.sp-=2,memory.writeByte(cpu.b,cpu.sp+1),memory.writeByte(cpu.c,cpu.sp),cpu.m=1,cpu.t=16,cpu.pc+=1},add_a_n:function(){var c=memory.readByte(cpu.pc+1),p=cpu.a+c;p>255?cpu.setCarryFlag():cpu.resetCarryFlag(),(15&cpu.a)+(15&c)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),cpu.a=255&p,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rst_0:function(){cpu.sp-=2,memory.writeWord(cpu.pc+1,cpu.sp),cpu.pc=0,cpu.m=1,cpu.t=16},ret_z:function(){cpu.zeroFlag()?(cpu.pc=memory.readWord(cpu.sp),cpu.sp+=2,cpu.t=20,cpu.m=1):(cpu.t=8,cpu.m=1,cpu.pc+=1)},ret:function(){cpu.pc=memory.readWord(cpu.sp),cpu.sp+=2,cpu.m=1,cpu.t=16},jp_z_nn:function(){cpu.zeroFlag()?(cpu.pc=memory.readWord(cpu.pc+1),cpu.t=16,cpu.m=3):(cpu.t=12,cpu.m=3,cpu.pc+=3)},ext_ops:function(){twoByteInstructions[memory.readByte(cpu.pc+1)]()},call_z_nn:function(){cpu.zeroFlag()?(cpu.sp-=2,memory.writeWord(cpu.pc+3,cpu.sp),cpu.pc=memory.readWord(cpu.pc+1),cpu.t=24,cpu.m=3):(cpu.t=12,cpu.m=3,cpu.pc+=3)},call_nn:function(){cpu.sp-=2,memory.writeWord(cpu.pc+3,cpu.sp),cpu.pc=memory.readWord(cpu.pc+1),cpu.t=24,cpu.m=3},adc_a_n:function(){var c=memory.readByte(cpu.pc+1),p=cpu.a+c;cpu.carryFlag()&&(p+=1),(15&cpu.a)+(15&c)+(cpu.f>>4&1)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),p>255?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(p&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=p,cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rst_8:function(){cpu.sp-=2,memory.writeWord(cpu.pc+1,cpu.sp),cpu.pc=8,cpu.m=1,cpu.t=16},ret_nc:function(){cpu.carryFlag()?(cpu.t=8,cpu.m=1,cpu.pc+=1):(cpu.pc=memory.readWord(cpu.sp),cpu.sp+=2,cpu.m=1,cpu.t=20)},pop_de:function(){cpu.e=memory.readByte(cpu.sp),cpu.d=memory.readByte(cpu.sp+1),cpu.sp+=2,cpu.m=1,cpu.t=12,cpu.pc+=1},jp_nc_nn:function(){cpu.carryFlag()?(cpu.t=12,cpu.m=3,cpu.pc+=3):(cpu.pc=memory.readWord(cpu.pc+1),cpu.t=16,cpu.m=3)},unused:function(){var c=memory.readByte(cpu.pc);console.log("invalid opcode ",c.toString(16),"at ",cpu.pc.toString(16)),window.clearInterval(cpu.timer)},call_nc_nn:function(){cpu.carryFlag()?(cpu.t=12,cpu.m=3,cpu.pc+=3):(cpu.sp-=2,memory.writeWord(cpu.pc+3,cpu.sp),cpu.pc=memory.readWord(cpu.pc+1),cpu.t=24,cpu.m=3)},push_de:function(){cpu.sp-=2,memory.writeByte(cpu.d,cpu.sp+1),memory.writeByte(cpu.e,cpu.sp),cpu.m=1,cpu.t=16,cpu.pc+=1},sub_a_n:function(){var c=memory.readByte(cpu.pc+1),p=cpu.a-c;p<0?cpu.setCarryFlag():cpu.resetCarryFlag(),p&=255,(15&cpu.a)-(15&c)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),0===p?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=p,cpu.setSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rst_10:function(){cpu.sp-=2,memory.writeWord(cpu.pc+1,cpu.sp),cpu.pc=16,cpu.m=1,cpu.t=16},ret_c:function(){cpu.carryFlag()?(cpu.pc=memory.readWord(cpu.sp),cpu.sp+=2,cpu.t=20,cpu.m=1):(cpu.t=8,cpu.m=1,cpu.pc+=1)},reti:function(){cpu.ime=1,cpu.pc=memory.readWord(cpu.sp),cpu.sp+=2,cpu.m=1,cpu.t=16},jp_c_nn:function(){cpu.carryFlag()?(cpu.pc=memory.readWord(cpu.pc+1),cpu.t=16,cpu.m=3):(cpu.t=12,cpu.m=3,cpu.pc+=3)},call_c_nn:function(){cpu.carryFlag()?(cpu.sp-=2,memory.writeWord(cpu.pc+3,cpu.sp),cpu.pc=memory.readWord(cpu.pc+1),cpu.t=24,cpu.m=3):(cpu.t=12,cpu.m=3,cpu.pc+=3)},sbc_a_n:function(){var c=memory.readByte(cpu.pc+1),p=cpu.a-c;cpu.carryFlag()&&(p-=1),(15&cpu.a)-(15&c)-(cpu.f>>4&1)<0?cpu.setHalfFlag():cpu.resetHalfFlag(),p<0?cpu.setCarryFlag():cpu.resetCarryFlag(),0===(p&=255)?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.a=p,cpu.setSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rst_18:function(){cpu.sp-=2,memory.writeWord(cpu.pc+1,cpu.sp),cpu.pc=24,cpu.m=1,cpu.t=16},ldh_n_a:function(){var c=65280|memory.readByte(cpu.pc+1);memory.writeByte(cpu.a,c),cpu.m=2,cpu.t=12,cpu.pc+=2},pop_hl:function(){cpu.l=memory.readByte(cpu.sp),cpu.h=memory.readByte(cpu.sp+1),cpu.sp+=2,cpu.m=1,cpu.t=12,cpu.pc+=1},ldh_c_a:function(){var c=65280+cpu.c;memory.writeByte(cpu.a,c),cpu.m=2,cpu.t=8,cpu.pc+=1},push_hl:function(){cpu.sp-=2,memory.writeByte(cpu.h,cpu.sp+1),memory.writeByte(cpu.l,cpu.sp),cpu.m=1,cpu.t=16,cpu.pc+=1},and_n:function(){var c=memory.readByte(cpu.pc+1);cpu.a&=c,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.resetCarryFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rst_20:function(){cpu.sp-=2,memory.writeWord(cpu.pc+1,cpu.sp),cpu.pc=32,cpu.m=1,cpu.t=16},add_sp_d:function(){var c=memory.readByte(cpu.pc+1);128&c&&(c|=65280);var p=cpu.sp+c;cpu.resetZeroFlag(),cpu.resetSubFlag(),(15&cpu.sp)+(15&c)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),(255&cpu.sp)+(255&c)>255?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.sp=65535&p,cpu.m=2,cpu.t=16,cpu.pc+=2},jp_hl:function(){cpu.pc=cpu.getAddr(cpu.h,cpu.l),cpu.m=1,cpu.t=4},ld_nn_a:function(){memory.writeByte(cpu.a,memory.readWord(cpu.pc+1)),cpu.m=3,cpu.t=16,cpu.pc+=3},xor_n:function(){var c=memory.readByte(cpu.pc+1);cpu.a^=c,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rst_28:function(){cpu.sp-=2,memory.writeWord(cpu.pc+1,cpu.sp),cpu.pc=40,cpu.m=1,cpu.t=16},ldh_a_n:function(){var c=65280+memory.readByte(cpu.pc+1);cpu.a=memory.readByte(c),cpu.m=2,cpu.t=12,cpu.pc+=2},pop_af:function(){cpu.f=memory.readByte(cpu.sp),cpu.f&=240,cpu.a=memory.readByte(cpu.sp+1),cpu.sp+=2,cpu.m=1,cpu.t=12,cpu.pc+=1},ldh_a_c:function(){var c=65280|cpu.c;cpu.a=memory.readByte(c),cpu.m=2,cpu.t=8,cpu.pc+=1},di:function(){cpu.ime=0,cpu.m=1,cpu.t=4,cpu.pc+=1},push_af:function(){cpu.sp-=2,memory.writeByte(cpu.a,cpu.sp+1),memory.writeByte(cpu.f,cpu.sp),cpu.m=1,cpu.t=16,cpu.pc+=1},or_n:function(){cpu.a|=memory.readByte(cpu.pc+1),0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.resetCarryFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rst_30:function(){cpu.sp-=2,memory.writeWord(cpu.pc+1,cpu.sp),cpu.pc=48,cpu.m=1,cpu.t=16},ldhl_sp_d:function(){var c=memory.readByte(cpu.pc+1);128&c&&(c|=65280);var p=cpu.sp+c;cpu.h=p>>8&255,cpu.l=255&p,(15&cpu.sp)+(15&c)>15?cpu.setHalfFlag():cpu.resetHalfFlag(),(255&cpu.sp)+(255&c)>255?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=12,cpu.pc+=2},ld_sp_hl:function(){cpu.sp=cpu.getAddr(cpu.h,cpu.l),cpu.m=1,cpu.t=8,cpu.pc+=1},ld_a_nn:function(){cpu.a=memory.readByte(memory.readWord(cpu.pc+1)),cpu.m=3,cpu.t=16,cpu.pc+=3},ei:function(){cpu.ime=1,cpu.m=1,cpu.t=4,cpu.pc+=1},cp_n:function(){var c=memory.readByte(cpu.pc+1),p=cpu.a-c;p<0?cpu.setCarryFlag():cpu.resetCarryFlag(),(15&cpu.a)<(15&c)?cpu.setHalfFlag():cpu.resetHalfFlag(),0===p?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.setSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rst_38:function(){cpu.sp-=2,memory.writeWord(cpu.pc+1,cpu.sp),cpu.pc=56,cpu.m=1,cpu.t=16},rlc_b:function(){var c=cpu.b>>7&1;1===c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.b=cpu.b<<1&255,cpu.b+=c,0===cpu.b?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rlc_c:function(){var c=cpu.c>>7&1;1===c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.c=cpu.c<<1&255,cpu.c+=c,0===cpu.c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rlc_d:function(){var c=cpu.d>>7&1;1===c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.d=cpu.d<<1&255,cpu.d+=c,0===cpu.d?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rlc_e:function(){var c=cpu.e>>7&1;1===c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.e=cpu.e<<1&255,cpu.e+=c,0===cpu.e?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rlc_h:function(){var c=cpu.h>>7&1;1===c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.h=cpu.h<<1&255,cpu.h+=c,0===cpu.h?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rlc_l:function(){var c=cpu.l>>7&1;1===c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.l=cpu.l<<1&255,cpu.l+=c,0===cpu.l?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rlc_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),p=c>>7&1;1===p?cpu.setCarryFlag():cpu.resetCarryFlag(),c=c<<1&255,c+=p,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=16,cpu.pc+=2},rlc_a:function(){var c=cpu.a>>7&1;1===c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.a=cpu.a<<1&255,cpu.a+=c,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rrc_b:function(){var c=cpu.b<<7&128;c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.b=cpu.b>>1,cpu.b+=c,0===cpu.b?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rrc_c:function(){var c=cpu.c<<7&128;c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.c=cpu.c>>1,cpu.c+=c,0===cpu.c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rrc_d:function(){var c=cpu.d<<7&128;c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.d=cpu.d>>1,cpu.d+=c,0===cpu.d?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rrc_e:function(){var c=cpu.e<<7&128;c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.e=cpu.e>>1,cpu.e+=c,0===cpu.e?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rrc_h:function(){var c=cpu.h<<7&128;c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.h=cpu.h>>1,cpu.h+=c,0===cpu.h?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rrc_l:function(){var c=cpu.l<<7&128;c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.l=cpu.l>>1,cpu.l+=c,0===cpu.l?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rrc_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),p=c<<7&128;p?cpu.setCarryFlag():cpu.resetCarryFlag(),c>>=1,c+=p,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.m=2,cpu.t=16,cpu.pc+=2},rrc_a:function(){var c=cpu.a<<7&128;c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.a=cpu.a>>1,cpu.a+=c,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetSubFlag(),cpu.resetHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rl_b:function(){var c=cpu.carryFlag()?1:0;128&cpu.b?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.b=cpu.b<<1,cpu.b+=c,cpu.b&=255,0===cpu.b?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rl_c:function(){var c=cpu.carryFlag()?1:0;128&cpu.c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.c=cpu.c<<1,cpu.c+=c,cpu.c&=255,0===cpu.c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rl_d:function(){var c=cpu.carryFlag()?1:0;128&cpu.d?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.d=cpu.d<<1,cpu.d+=c,cpu.d&=255,0===cpu.d?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rl_e:function(){var c=cpu.carryFlag()?1:0;128&cpu.e?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.e=cpu.e<<1,cpu.e+=c,cpu.e&=255,0===cpu.e?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rl_h:function(){var c=cpu.carryFlag()?1:0;128&cpu.h?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.h=cpu.h<<1,cpu.h+=c,cpu.h&=255,0===cpu.h?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rl_l:function(){var c=cpu.carryFlag()?1:0;128&cpu.l?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.l=cpu.l<<1,cpu.l+=c,cpu.l&=255,0===cpu.l?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rl_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),p=cpu.carryFlag()?1:0;128&c?cpu.setCarryFlag():cpu.resetCarryFlag(),c<<=1,c+=p,c&=255,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=16,cpu.pc+=2},rl_a:function(){var c=cpu.carryFlag()?1:0;128&cpu.a?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.a=cpu.a<<1,cpu.a+=c,cpu.a&=255,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rr_b:function(){var c=cpu.carryFlag()?128:0;1&cpu.b?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.b=cpu.b>>1,cpu.b+=c,cpu.b&=255,0===cpu.b?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rr_c:function(){var c=cpu.carryFlag()?128:0;1&cpu.c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.c=cpu.c>>1,cpu.c+=c,cpu.c&=255,0===cpu.c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rr_d:function(){var c=cpu.carryFlag()?128:0;1&cpu.d?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.d=cpu.d>>1,cpu.d+=c,cpu.d&=255,0===cpu.d?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rr_e:function(){var c=cpu.carryFlag()?128:0;1==(1&cpu.e)?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.e=cpu.e>>1,cpu.e+=c,cpu.e&=255,0===cpu.e?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rr_h:function(){var c=cpu.carryFlag()?128:0;1&cpu.h?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.h=cpu.h>>1,cpu.h+=c,cpu.h&=255,0===cpu.h?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rr_l:function(){var c=cpu.carryFlag()?128:0;1&cpu.l?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.l=cpu.l>>1,cpu.l+=c,cpu.l&=255,0===cpu.l?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},rr_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l)),p=cpu.carryFlag()?128:0;1&c?cpu.setCarryFlag():cpu.resetCarryFlag(),c>>=1,c+=p,c&=255,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=16,cpu.pc+=2},rr_a:function(){var c=cpu.carryFlag()?128:0;1&cpu.a?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.a=cpu.a>>1,cpu.a+=c,cpu.a&=255,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sla_b:function(){128&cpu.b?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.b=cpu.b<<1,cpu.b&=255,0===cpu.b?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sla_c:function(){128&cpu.c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.c=cpu.c<<1,cpu.c&=255,0===cpu.c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sla_d:function(){128&cpu.d?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.d=cpu.d<<1,cpu.d&=255,0===cpu.d?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sla_e:function(){128&cpu.e?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.e=cpu.e<<1,cpu.e&=255,0===cpu.e?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sla_h:function(){128&cpu.h?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.h=cpu.h<<1,cpu.h&=255,0===cpu.h?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sla_l:function(){128&cpu.l?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.l=cpu.l<<1,cpu.l&=255,0===cpu.l?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sla_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));128&c?cpu.setCarryFlag():cpu.resetCarryFlag(),c<<=1,c&=255,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=16,cpu.pc+=2},sla_a:function(){128&cpu.a?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.a=cpu.a<<1,cpu.a&=255,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sra_b:function(){1&cpu.b?cpu.setCarryFlag():cpu.resetCarryFlag();var c=128&cpu.b;cpu.b=cpu.b>>1,cpu.b|=c,0===cpu.b?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sra_c:function(){1&cpu.c?cpu.setCarryFlag():cpu.resetCarryFlag();var c=128&cpu.c;cpu.c=cpu.c>>1,cpu.c|=c,0===cpu.c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sra_d:function(){1&cpu.d?cpu.setCarryFlag():cpu.resetCarryFlag();var c=128&cpu.d;cpu.d=cpu.d>>1,cpu.d|=c,0===cpu.d?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sra_e:function(){1&cpu.e?cpu.setCarryFlag():cpu.resetCarryFlag();var c=128&cpu.e;cpu.e=cpu.e>>1,cpu.e|=c,0===cpu.e?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sra_h:function(){1&cpu.h?cpu.setCarryFlag():cpu.resetCarryFlag();var c=128&cpu.h;cpu.h=cpu.h>>1,cpu.h|=c,0===cpu.h?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sra_l:function(){1&cpu.l?cpu.setCarryFlag():cpu.resetCarryFlag();var c=128&cpu.l;cpu.l=cpu.l>>1,cpu.l|=c,0===cpu.l?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},sra_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));1&c?cpu.setCarryFlag():cpu.resetCarryFlag();var p=128&c;c>>=1,c|=p,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=16,cpu.pc+=2},sra_a:function(){1&cpu.a?cpu.setCarryFlag():cpu.resetCarryFlag();var c=128&cpu.a;cpu.a=cpu.a>>1,cpu.a|=c,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},swap_b:function(){if(0===cpu.b)cpu.setZeroFlag();else{var c=15&cpu.b;cpu.b=cpu.b>>4,c<<=4,cpu.b|=c,cpu.resetZeroFlag()}cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.resetCarryFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},swap_c:function(){if(0===cpu.c)cpu.setZeroFlag();else{var c=15&cpu.c;cpu.c=cpu.c>>4,c<<=4,cpu.c|=c,cpu.resetZeroFlag()}cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.resetCarryFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},swap_d:function(){if(0===cpu.d)cpu.setZeroFlag();else{var c=15&cpu.d;cpu.d=cpu.d>>4,c<<=4,cpu.d|=c,cpu.resetZeroFlag()}cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.resetCarryFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},swap_e:function(){if(0===cpu.e)cpu.setZeroFlag();else{var c=15&cpu.e;cpu.e=cpu.e>>4,c<<=4,cpu.e|=c,cpu.resetZeroFlag()}cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.resetCarryFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},swap_h:function(){if(0===cpu.h)cpu.setZeroFlag();else{var c=15&cpu.h;cpu.h=cpu.h>>4,c<<=4,cpu.h|=c,cpu.resetZeroFlag()}cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.resetCarryFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},swap_l:function(){if(0===cpu.l)cpu.setZeroFlag();else{var c=15&cpu.l;cpu.l=cpu.l>>4,c<<=4,cpu.l|=c,cpu.resetZeroFlag()}cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.resetCarryFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},swap_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));if(0===c)cpu.setZeroFlag();else{var p=15&c;c>>=4,c|=p<<=4,cpu.resetZeroFlag(),memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l))}cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.resetCarryFlag(),cpu.m=2,cpu.t=16,cpu.pc+=2},swap_a:function(){if(0===cpu.a)cpu.setZeroFlag();else{var c=15&cpu.a;cpu.a=cpu.a>>4,c<<=4,cpu.a|=c,cpu.resetZeroFlag()}cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.resetCarryFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},srl_b:function(){1&cpu.b?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.b=cpu.b>>1,0===cpu.b?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},srl_c:function(){1&cpu.c?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.c=cpu.c>>1,0===cpu.c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},srl_d:function(){1&cpu.d?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.d=cpu.d>>1,0===cpu.d?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},srl_e:function(){1&cpu.e?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.e=cpu.e>>1,0===cpu.e?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},srl_h:function(){1&cpu.h?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.h=cpu.h>>1,0===cpu.h?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},srl_l:function(){1&cpu.l?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.l=cpu.l>>1,0===cpu.l?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},srl_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));1&c?cpu.setCarryFlag():cpu.resetCarryFlag(),c>>=1,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),0===c?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=16,cpu.pc+=2},srl_a:function(){1&cpu.a?cpu.setCarryFlag():cpu.resetCarryFlag(),cpu.a=cpu.a>>1,0===cpu.a?cpu.setZeroFlag():cpu.resetZeroFlag(),cpu.resetHalfFlag(),cpu.resetSubFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_0_b:function(){1&cpu.b?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_0_c:function(){1&cpu.c?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_0_d:function(){1&cpu.d?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_0_e:function(){1&cpu.e?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_0_h:function(){1&cpu.h?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_0_l:function(){1&cpu.l?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_0_hl:function(){1&memory.readByte(cpu.getAddr(cpu.h,cpu.l))?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=12,cpu.pc+=2},bit_0_a:function(){1&cpu.a?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_1_b:function(){2&cpu.b?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_1_c:function(){2&cpu.c?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_1_d:function(){2&cpu.d?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_1_e:function(){2&cpu.e?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_1_h:function(){2&cpu.h?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_1_l:function(){2&cpu.l?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_1_hl:function(){2&memory.readByte(cpu.getAddr(cpu.h,cpu.l))?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=12,cpu.pc+=2},bit_1_a:function(){2&cpu.a?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_2_b:function(){4&cpu.b?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_2_c:function(){4&cpu.c?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_2_d:function(){4&cpu.d?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_2_e:function(){4&cpu.e?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_2_h:function(){4&cpu.h?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_2_l:function(){4&cpu.l?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_2_hl:function(){4&memory.readByte(cpu.getAddr(cpu.h,cpu.l))?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=12,cpu.pc+=2},bit_2_a:function(){4&cpu.a?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_3_b:function(){8&cpu.b?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_3_c:function(){8&cpu.c?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_3_d:function(){8&cpu.d?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_3_e:function(){8&cpu.e?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_3_h:function(){8&cpu.h?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_3_l:function(){8&cpu.l?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_3_hl:function(){8&memory.readByte(cpu.getAddr(cpu.h,cpu.l))?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=12,cpu.pc+=2},bit_3_a:function(){8&cpu.a?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_4_b:function(){16&cpu.b?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_4_c:function(){16&cpu.c?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_4_d:function(){16&cpu.d?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_4_e:function(){16&cpu.e?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_4_h:function(){16&cpu.h?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_4_l:function(){16&cpu.l?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_4_hl:function(){16&memory.readByte(cpu.getAddr(cpu.h,cpu.l))?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=12,cpu.pc+=2},bit_4_a:function(){16&cpu.a?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_5_b:function(){32&cpu.b?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_5_c:function(){32&cpu.c?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_5_d:function(){32&cpu.d?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_5_e:function(){32&cpu.e?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_5_h:function(){32&cpu.h?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_5_l:function(){32&cpu.l?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_5_hl:function(){32&memory.readByte(cpu.getAddr(cpu.h,cpu.l))?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=12,cpu.pc+=2},bit_5_a:function(){32&cpu.a?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_6_b:function(){64&cpu.b?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_6_c:function(){64&cpu.c?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_6_d:function(){64&cpu.d?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_6_e:function(){64&cpu.e?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_6_h:function(){64&cpu.h?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_6_l:function(){64&cpu.l?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_6_hl:function(){64&memory.readByte(cpu.getAddr(cpu.h,cpu.l))?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=12,cpu.pc+=2},bit_6_a:function(){64&cpu.a?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_7_b:function(){128&cpu.b?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_7_c:function(){128&cpu.c?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_7_d:function(){128&cpu.d?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_7_e:function(){128&cpu.e?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_7_h:function(){128&cpu.h?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_7_l:function(){128&cpu.l?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},bit_7_hl:function(){128&memory.readByte(cpu.getAddr(cpu.h,cpu.l))?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=12,cpu.pc+=2},bit_7_a:function(){128&cpu.a?cpu.resetZeroFlag():cpu.setZeroFlag(),cpu.resetSubFlag(),cpu.setHalfFlag(),cpu.m=2,cpu.t=8,cpu.pc+=2},res_0_b:function(){cpu.b&=254,cpu.m=2,cpu.t=8,cpu.pc+=2},res_0_c:function(){cpu.c&=254,cpu.m=2,cpu.t=8,cpu.pc+=2},res_0_d:function(){cpu.d&=254,cpu.m=2,cpu.t=8,cpu.pc+=2},res_0_e:function(){cpu.e&=254,cpu.m=2,cpu.t=8,cpu.pc+=2},res_0_h:function(){cpu.h&=254,cpu.m=2,cpu.t=8,cpu.pc+=2},res_0_l:function(){cpu.l&=254,cpu.m=2,cpu.t=8,cpu.pc+=2},res_0_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c&=254,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},res_0_a:function(){cpu.a&=254,cpu.m=2,cpu.t=8,cpu.pc+=2},res_1_b:function(){cpu.b&=253,cpu.m=2,cpu.t=8,cpu.pc+=2},res_1_c:function(){cpu.c&=253,cpu.m=2,cpu.t=8,cpu.pc+=2},res_1_d:function(){cpu.d&=253,cpu.m=2,cpu.t=8,cpu.pc+=2},res_1_e:function(){cpu.e&=253,cpu.m=2,cpu.t=8,cpu.pc+=2},res_1_h:function(){cpu.h&=253,cpu.m=2,cpu.t=8,cpu.pc+=2},res_1_l:function(){cpu.l&=253,cpu.m=2,cpu.t=8,cpu.pc+=2},res_1_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c&=253,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},res_1_a:function(){cpu.a&=253,cpu.m=2,cpu.t=8,cpu.pc+=2},res_2_b:function(){cpu.b&=251,cpu.m=2,cpu.t=8,cpu.pc+=2},res_2_c:function(){cpu.c&=251,cpu.m=2,cpu.t=8,cpu.pc+=2},res_2_d:function(){cpu.d&=251,cpu.m=2,cpu.t=8,cpu.pc+=2},res_2_e:function(){cpu.e&=251,cpu.m=2,cpu.t=8,cpu.pc+=2},res_2_h:function(){cpu.h&=251,cpu.m=2,cpu.t=8,cpu.pc+=2},res_2_l:function(){cpu.l&=251,cpu.m=2,cpu.t=8,cpu.pc+=2},res_2_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c&=251,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},res_2_a:function(){cpu.a&=251,cpu.m=2,cpu.t=8,cpu.pc+=2},res_3_b:function(){cpu.b&=247,cpu.m=2,cpu.t=8,cpu.pc+=2},res_3_c:function(){cpu.c&=247,cpu.m=2,cpu.t=8,cpu.pc+=2},res_3_d:function(){cpu.d&=247,cpu.m=2,cpu.t=8,cpu.pc+=2},res_3_e:function(){cpu.e&=247,cpu.m=2,cpu.t=8,cpu.pc+=2},res_3_h:function(){cpu.h&=247,cpu.m=2,cpu.t=8,cpu.pc+=2},res_3_l:function(){cpu.l&=247,cpu.m=2,cpu.t=8,cpu.pc+=2},res_3_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c&=247,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},res_3_a:function(){cpu.a&=247,cpu.m=2,cpu.t=8,cpu.pc+=2},res_4_b:function(){cpu.b&=239,cpu.m=2,cpu.t=8,cpu.pc+=2},res_4_c:function(){cpu.c&=239,cpu.m=2,cpu.t=8,cpu.pc+=2},res_4_d:function(){cpu.d&=239,cpu.m=2,cpu.t=8,cpu.pc+=2},res_4_e:function(){cpu.e&=239,cpu.m=2,cpu.t=8,cpu.pc+=2},res_4_h:function(){cpu.h&=239,cpu.m=2,cpu.t=8,cpu.pc+=2},res_4_l:function(){cpu.l&=239,cpu.m=2,cpu.t=8,cpu.pc+=2},res_4_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c&=239,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},res_4_a:function(){cpu.a&=239,cpu.m=2,cpu.t=8,cpu.pc+=2},res_5_b:function(){cpu.b&=223,cpu.m=2,cpu.t=8,cpu.pc+=2},res_5_c:function(){cpu.c&=223,cpu.m=2,cpu.t=8,cpu.pc+=2},res_5_d:function(){cpu.d&=223,cpu.m=2,cpu.t=8,cpu.pc+=2},res_5_e:function(){cpu.e&=223,cpu.m=2,cpu.t=8,cpu.pc+=2},res_5_h:function(){cpu.h&=223,cpu.m=2,cpu.t=8,cpu.pc+=2},res_5_l:function(){cpu.l&=223,cpu.m=2,cpu.t=8,cpu.pc+=2},res_5_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c&=223,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},res_5_a:function(){cpu.a&=223,cpu.m=2,cpu.t=8,cpu.pc+=2},res_6_b:function(){cpu.b&=191,cpu.m=2,cpu.t=8,cpu.pc+=2},res_6_c:function(){cpu.c&=191,cpu.m=2,cpu.t=8,cpu.pc+=2},res_6_d:function(){cpu.d&=191,cpu.m=2,cpu.t=8,cpu.pc+=2},res_6_e:function(){cpu.e&=191,cpu.m=2,cpu.t=8,cpu.pc+=2},res_6_h:function(){cpu.h&=191,cpu.m=2,cpu.t=8,cpu.pc+=2},res_6_l:function(){cpu.l&=191,cpu.m=2,cpu.t=8,cpu.pc+=2},res_6_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c&=191,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},res_6_a:function(){cpu.a&=191,cpu.m=2,cpu.t=8,cpu.pc+=2},res_7_b:function(){cpu.b&=127,cpu.m=2,cpu.t=8,cpu.pc+=2},res_7_c:function(){cpu.c&=127,cpu.m=2,cpu.t=8,cpu.pc+=2},res_7_d:function(){cpu.d&=127,cpu.m=2,cpu.t=8,cpu.pc+=2},res_7_e:function(){cpu.e&=127,cpu.m=2,cpu.t=8,cpu.pc+=2},res_7_h:function(){cpu.h&=127,cpu.m=2,cpu.t=8,cpu.pc+=2},res_7_l:function(){cpu.l&=127,cpu.m=2,cpu.t=8,cpu.pc+=2},res_7_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c&=127,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},res_7_a:function(){cpu.a&=127,cpu.m=2,cpu.t=8,cpu.pc+=2},set_0_b:function(){cpu.b|=1,cpu.m=2,cpu.t=8,cpu.pc+=2},set_0_c:function(){cpu.c|=1,cpu.m=2,cpu.t=8,cpu.pc+=2},set_0_d:function(){cpu.d|=1,cpu.m=2,cpu.t=8,cpu.pc+=2},set_0_e:function(){cpu.e|=1,cpu.m=2,cpu.t=8,cpu.pc+=2},set_0_h:function(){cpu.h|=1,cpu.m=2,cpu.t=8,cpu.pc+=2},set_0_l:function(){cpu.l|=1,cpu.m=2,cpu.t=8,cpu.pc+=2},set_0_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c|=1,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},set_0_a:function(){cpu.a|=1,cpu.m=2,cpu.t=8,cpu.pc+=2},set_1_b:function(){cpu.b|=2,cpu.m=2,cpu.t=8,cpu.pc+=2},set_1_c:function(){cpu.c|=2,cpu.m=2,cpu.t=8,cpu.pc+=2},set_1_d:function(){cpu.d|=2,cpu.m=2,cpu.t=8,cpu.pc+=2},set_1_e:function(){cpu.e|=2,cpu.m=2,cpu.t=8,cpu.pc+=2},set_1_h:function(){cpu.h|=2,cpu.m=2,cpu.t=8,cpu.pc+=2},set_1_l:function(){cpu.l|=2,cpu.m=2,cpu.t=8,cpu.pc+=2},set_1_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c|=2,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},set_1_a:function(){cpu.a|=2,cpu.m=2,cpu.t=8,cpu.pc+=2},set_2_b:function(){cpu.b|=4,cpu.m=2,cpu.t=8,cpu.pc+=2},set_2_c:function(){cpu.c|=4,cpu.m=2,cpu.t=8,cpu.pc+=2},set_2_d:function(){cpu.d|=4,cpu.m=2,cpu.t=8,cpu.pc+=2},set_2_e:function(){cpu.e|=4,cpu.m=2,cpu.t=8,cpu.pc+=2},set_2_h:function(){cpu.h|=4,cpu.m=2,cpu.t=8,cpu.pc+=2},set_2_l:function(){cpu.l|=4,cpu.m=2,cpu.t=8,cpu.pc+=2},set_2_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c|=4,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},set_2_a:function(){cpu.a|=4,cpu.m=2,cpu.t=8,cpu.pc+=2},set_3_b:function(){cpu.b|=8,cpu.m=2,cpu.t=8,cpu.pc+=2},set_3_c:function(){cpu.c|=8,cpu.m=2,cpu.t=8,cpu.pc+=2},set_3_d:function(){cpu.d|=8,cpu.m=2,cpu.t=8,cpu.pc+=2},set_3_e:function(){cpu.e|=8,cpu.m=2,cpu.t=8,cpu.pc+=2},set_3_h:function(){cpu.h|=8,cpu.m=2,cpu.t=8,cpu.pc+=2},set_3_l:function(){cpu.l|=8,cpu.m=2,cpu.t=8,cpu.pc+=2},set_3_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c|=8,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},set_3_a:function(){cpu.a|=8,cpu.m=2,cpu.t=8,cpu.pc+=2},set_4_b:function(){cpu.b|=16,cpu.m=2,cpu.t=8,cpu.pc+=2},set_4_c:function(){cpu.c|=16,cpu.m=2,cpu.t=8,cpu.pc+=2},set_4_d:function(){cpu.d|=16,cpu.m=2,cpu.t=8,cpu.pc+=2},set_4_e:function(){cpu.e|=16,cpu.m=2,cpu.t=8,cpu.pc+=2},set_4_h:function(){cpu.h|=16,cpu.m=2,cpu.t=8,cpu.pc+=2},set_4_l:function(){cpu.l|=16,cpu.m=2,cpu.t=8,cpu.pc+=2},set_4_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c|=16,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},set_4_a:function(){cpu.a|=16,cpu.m=2,cpu.t=8,cpu.pc+=2},set_5_b:function(){cpu.b|=32,cpu.m=2,cpu.t=8,cpu.pc+=2},set_5_c:function(){cpu.c|=32,cpu.m=2,cpu.t=8,cpu.pc+=2},set_5_d:function(){cpu.d|=32,cpu.m=2,cpu.t=8,cpu.pc+=2},set_5_e:function(){cpu.e|=32,cpu.m=2,cpu.t=8,cpu.pc+=2},set_5_h:function(){cpu.h|=32,cpu.m=2,cpu.t=8,cpu.pc+=2},set_5_l:function(){cpu.l|=32,cpu.m=2,cpu.t=8,cpu.pc+=2},set_5_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c|=32,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},set_5_a:function(){cpu.a|=32,cpu.m=2,cpu.t=8,cpu.pc+=2},set_6_b:function(){cpu.b|=64,cpu.m=2,cpu.t=8,cpu.pc+=2},set_6_c:function(){cpu.c|=64,cpu.m=2,cpu.t=8,cpu.pc+=2},set_6_d:function(){cpu.d|=64,cpu.m=2,cpu.t=8,cpu.pc+=2},set_6_e:function(){cpu.e|=64,cpu.m=2,cpu.t=8,cpu.pc+=2},set_6_h:function(){cpu.h|=64,cpu.m=2,cpu.t=8,cpu.pc+=2},set_6_l:function(){cpu.l|=64,cpu.m=2,cpu.t=8,cpu.pc+=2},set_6_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c|=64,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},set_6_a:function(){cpu.a|=64,cpu.m=2,cpu.t=8,cpu.pc+=2},set_7_b:function(){cpu.b|=128,cpu.m=2,cpu.t=8,cpu.pc+=2},set_7_c:function(){cpu.c|=128,cpu.m=2,cpu.t=8,cpu.pc+=2},set_7_d:function(){cpu.d|=128,cpu.m=2,cpu.t=8,cpu.pc+=2},set_7_e:function(){cpu.e|=128,cpu.m=2,cpu.t=8,cpu.pc+=2},set_7_h:function(){cpu.h|=128,cpu.m=2,cpu.t=8,cpu.pc+=2},set_7_l:function(){cpu.l|=128,cpu.m=2,cpu.t=8,cpu.pc+=2},set_7_hl:function(){var c=memory.readByte(cpu.getAddr(cpu.h,cpu.l));c|=128,memory.writeByte(c,cpu.getAddr(cpu.h,cpu.l)),cpu.m=2,cpu.t=16,cpu.pc+=2},set_7_a:function(){cpu.a|=128,cpu.m=2,cpu.t=8,cpu.pc+=2},zeroFlag:function(){return!!(128&cpu.f)},setZeroFlag:function(){cpu.f|=128},resetZeroFlag:function(){cpu.f&=112},subFlag:function(){return!!(64&cpu.f)},setSubFlag:function(){cpu.f|=64},resetSubFlag:function(){cpu.f&=176},halfFlag:function(){return!!(32&cpu.f)},setHalfFlag:function(){cpu.f|=32},resetHalfFlag:function(){cpu.f&=208},carryFlag:function(){return!!(16&cpu.f)},setCarryFlag:function(){cpu.f|=16},resetCarryFlag:function(){cpu.f&=224},interruptEnabled:function(){return 0!=cpu.ime},getAddr:function(c,p){var u=c;return u<<=8,u|=p},ex:function(c){cpu.pcPrev=cpu.pc,oneByteInstructions[c](),cpu.pc&=65535,display.step(),timer.step(),interrupt.step()},runInstruction:function(){cpu.showFunc(),cpu.ex(memory.readByte(cpu.pc)),cpu.showState(),display.showState()},showFunc:function(){console.log("executing: MEMORY[",cpu.pc.toString(16),"], ",oneByteInstructions[memory.readByte(cpu.pc)].name,", hex ",memory.readByte(cpu.pc).toString(16))},showState:function(){console.log("current state: "),console.log("AF: ",cpu.toHex(cpu.a),cpu.toHex(cpu.f)),console.log("BC: ",cpu.toHex(cpu.b),cpu.toHex(cpu.c)),console.log("DE: ",cpu.toHex(cpu.d),cpu.toHex(cpu.e)),console.log("HL: ",cpu.toHex(cpu.h),cpu.toHex(cpu.l)),console.log("sp: ",cpu.sp.toString(16)),console.log("pc: ",cpu.pc.toString(16)),console.log("m: ",cpu.m),console.log("t: ",cpu.t),console.log("divCnt: ",cpu.toHex(timer.divCnt)),console.log("DIV(FF04):",cpu.toHex(MEMORY[65284])),console.log("timaCnt: ",cpu.toHex(timer.timaCnt)),console.log("TIMA(FF05):",cpu.toHex(MEMORY[65285])),console.log("TMA(FF06):",cpu.toHex(MEMORY[65286])),console.log("TAC(FF07):",cpu.toHex(MEMORY[65287])),console.log("IF:",cpu.toHex(MEMORY[65295])),console.log("IE:",cpu.toHex(MEMORY[65535]))},toHex:function(c){for(var p=c.toString(16);p.length<2;)p="0"+p;return p},signDecode:function(c){return 128&c&&(c=255&~c,c=-++c),c}},oneByteInstructions=[cpu.nop,cpu.ld_bc_nn,cpu.ld_bc_a,cpu.inc_bc,cpu.inc_b,cpu.dec_b,cpu.ld_b_n,cpu.rlca,cpu.ld_nn_sp,cpu.add_hl_bc,cpu.ld_a_bc,cpu.dec_bc,cpu.inc_c,cpu.dec_c,cpu.ld_c_n,cpu.rrca,cpu.stop,cpu.ld_de_nn,cpu.ld_de_a,cpu.inc_de,cpu.inc_d,cpu.dec_d,cpu.ld_d_n,cpu.rla,cpu.jr_n,cpu.add_hl_de,cpu.ld_a_de,cpu.dec_de,cpu.inc_e,cpu.dec_e,cpu.ld_e_n,cpu.rra,cpu.jr_nz_n,cpu.ld_hl_nn,cpu.ldi_hl_a,cpu.inc_hl,cpu.inc_h,cpu.dec_h,cpu.ld_h_n,cpu.daa,cpu.jr_z_n,cpu.add_hl_hl,cpu.ldi_a_hl,cpu.dec_hl,cpu.inc_l,cpu.dec_l,cpu.ld_l_n,cpu.cpl,cpu.jr_nc_n,cpu.ld_sp_nn,cpu.ldd_hl_a,cpu.inc_sp,cpu.inc_hl_,cpu.dec_hl_,cpu.ld_hl_n,cpu.scf,cpu.jr_c_n,cpu.add_hl_sp,cpu.ldd_a_hl,cpu.dec_sp,cpu.inc_a,cpu.dec_a,cpu.ld_a_n,cpu.ccf,cpu.ld_b_b,cpu.ld_b_c,cpu.ld_b_d,cpu.ld_b_e,cpu.ld_b_h,cpu.ld_b_l,cpu.ld_b_hl,cpu.ld_b_a,cpu.ld_c_b,cpu.ld_c_c,cpu.ld_c_d,cpu.ld_c_e,cpu.ld_c_h,cpu.ld_c_l,cpu.ld_c_hl,cpu.ld_c_a,cpu.ld_d_b,cpu.ld_d_c,cpu.ld_d_d,cpu.ld_d_e,cpu.ld_d_h,cpu.ld_d_l,cpu.ld_d_hl,cpu.ld_d_a,cpu.ld_e_b,cpu.ld_e_c,cpu.ld_e_d,cpu.ld_e_e,cpu.ld_e_h,cpu.ld_e_l,cpu.ld_e_hl,cpu.ld_e_a,cpu.ld_h_b,cpu.ld_h_c,cpu.ld_h_d,cpu.ld_h_e,cpu.ld_h_h,cpu.ld_h_l,cpu.ld_h_hl,cpu.ld_h_a,cpu.ld_l_b,cpu.ld_l_c,cpu.ld_l_d,cpu.ld_l_e,cpu.ld_l_h,cpu.ld_l_l,cpu.ld_l_hl,cpu.ld_l_a,cpu.ld_hl_b,cpu.ld_hl_c,cpu.ld_hl_d,cpu.ld_hl_e,cpu.ld_hl_h,cpu.ld_hl_l,cpu.halt,cpu.ld_hl_a,cpu.ld_a_b,cpu.ld_a_c,cpu.ld_a_d,cpu.ld_a_e,cpu.ld_a_h,cpu.ld_a_l,cpu.ld_a_hl,cpu.ld_a_a,cpu.add_a_b,cpu.add_a_c,cpu.add_a_d,cpu.add_a_e,cpu.add_a_h,cpu.add_a_l,cpu.add_a_hl,cpu.add_a_a,cpu.adc_b_a,cpu.adc_c_a,cpu.adc_d_a,cpu.adc_e_a,cpu.adc_h_a,cpu.adc_l_a,cpu.adc_hl_a,cpu.adc_a_a,cpu.sub_b_a,cpu.sub_c_a,cpu.sub_d_a,cpu.sub_e_a,cpu.sub_h_a,cpu.sub_l_a,cpu.sub_hl_a,cpu.sub_a_a,cpu.sbc_b_a,cpu.sbc_c_a,cpu.sbc_d_a,cpu.sbc_e_a,cpu.sbc_h_a,cpu.sbc_l_a,cpu.sbc_hl_a,cpu.sbc_a_a,cpu.and_b,cpu.and_c,cpu.and_d,cpu.and_e,cpu.and_h,cpu.and_l,cpu.and_hl,cpu.and_a,cpu.xor_b,cpu.xor_c,cpu.xor_d,cpu.xor_e,cpu.xor_h,cpu.xor_l,cpu.xor_hl,cpu.xor_a,cpu.or_b,cpu.or_c,cpu.or_d,cpu.or_e,cpu.or_h,cpu.or_l,cpu.or_hl,cpu.or_a,cpu.cp_b,cpu.cp_c,cpu.cp_d,cpu.cp_e,cpu.cp_h,cpu.cp_l,cpu.cp_hl,cpu.cp_a,cpu.ret_nz,cpu.pop_bc,cpu.jp_nz_nn,cpu.jp_nn,cpu.call_nz_nn,cpu.push_bc,cpu.add_a_n,cpu.rst_0,cpu.ret_z,cpu.ret,cpu.jp_z_nn,cpu.ext_ops,cpu.call_z_nn,cpu.call_nn,cpu.adc_a_n,cpu.rst_8,cpu.ret_nc,cpu.pop_de,cpu.jp_nc_nn,cpu.unused,cpu.call_nc_nn,cpu.push_de,cpu.sub_a_n,cpu.rst_10,cpu.ret_c,cpu.reti,cpu.jp_c_nn,cpu.unused,cpu.call_c_nn,cpu.unused,cpu.sbc_a_n,cpu.rst_18,cpu.ldh_n_a,cpu.pop_hl,cpu.ldh_c_a,cpu.unused,cpu.unused,cpu.push_hl,cpu.and_n,cpu.rst_20,cpu.add_sp_d,cpu.jp_hl,cpu.ld_nn_a,cpu.unused,cpu.unused,cpu.unused,cpu.xor_n,cpu.rst_28,cpu.ldh_a_n,cpu.pop_af,cpu.ldh_a_c,cpu.di,cpu.unused,cpu.push_af,cpu.or_n,cpu.rst_30,cpu.ldhl_sp_d,cpu.ld_sp_hl,cpu.ld_a_nn,cpu.ei,cpu.unused,cpu.unused,cpu.cp_n,cpu.rst_38],twoByteInstructions=[cpu.rlc_b,cpu.rlc_c,cpu.rlc_d,cpu.rlc_e,cpu.rlc_h,cpu.rlc_l,cpu.rlc_hl,cpu.rlc_a,cpu.rrc_b,cpu.rrc_c,cpu.rrc_d,cpu.rrc_e,cpu.rrc_h,cpu.rrc_l,cpu.rrc_hl,cpu.rrc_a,cpu.rl_b,cpu.rl_c,cpu.rl_d,cpu.rl_e,cpu.rl_h,cpu.rl_l,cpu.rl_hl,cpu.rl_a,cpu.rr_b,cpu.rr_c,cpu.rr_d,cpu.rr_e,cpu.rr_h,cpu.rr_l,cpu.rr_hl,cpu.rr_a,cpu.sla_b,cpu.sla_c,cpu.sla_d,cpu.sla_e,cpu.sla_h,cpu.sla_l,cpu.sla_hl,cpu.sla_a,cpu.sra_b,cpu.sra_c,cpu.sra_d,cpu.sra_e,cpu.sra_h,cpu.sra_l,cpu.sra_hl,cpu.sra_a,cpu.swap_b,cpu.swap_c,cpu.swap_d,cpu.swap_e,cpu.swap_h,cpu.swap_l,cpu.swap_hl,cpu.swap_a,cpu.srl_b,cpu.srl_c,cpu.srl_d,cpu.srl_e,cpu.srl_h,cpu.srl_l,cpu.srl_hl,cpu.srl_a,cpu.bit_0_b,cpu.bit_0_c,cpu.bit_0_d,cpu.bit_0_e,cpu.bit_0_h,cpu.bit_0_l,cpu.bit_0_hl,cpu.bit_0_a,cpu.bit_1_b,cpu.bit_1_c,cpu.bit_1_d,cpu.bit_1_e,cpu.bit_1_h,cpu.bit_1_l,cpu.bit_1_hl,cpu.bit_1_a,cpu.bit_2_b,cpu.bit_2_c,cpu.bit_2_d,cpu.bit_2_e,cpu.bit_2_h,cpu.bit_2_l,cpu.bit_2_hl,cpu.bit_2_a,cpu.bit_3_b,cpu.bit_3_c,cpu.bit_3_d,cpu.bit_3_e,cpu.bit_3_h,cpu.bit_3_l,cpu.bit_3_hl,cpu.bit_3_a,cpu.bit_4_b,cpu.bit_4_c,cpu.bit_4_d,cpu.bit_4_e,cpu.bit_4_h,cpu.bit_4_l,cpu.bit_4_hl,cpu.bit_4_a,cpu.bit_5_b,cpu.bit_5_c,cpu.bit_5_d,cpu.bit_5_e,cpu.bit_5_h,cpu.bit_5_l,cpu.bit_5_hl,cpu.bit_5_a,cpu.bit_6_b,cpu.bit_6_c,cpu.bit_6_d,cpu.bit_6_e,cpu.bit_6_h,cpu.bit_6_l,cpu.bit_6_hl,cpu.bit_6_a,cpu.bit_7_b,cpu.bit_7_c,cpu.bit_7_d,cpu.bit_7_e,cpu.bit_7_h,cpu.bit_7_l,cpu.bit_7_hl,cpu.bit_7_a,cpu.res_0_b,cpu.res_0_c,cpu.res_0_d,cpu.res_0_e,cpu.res_0_h,cpu.res_0_l,cpu.res_0_hl,cpu.res_0_a,cpu.res_1_b,cpu.res_1_c,cpu.res_1_d,cpu.res_1_e,cpu.res_1_h,cpu.res_1_l,cpu.res_1_hl,cpu.res_1_a,cpu.res_2_b,cpu.res_2_c,cpu.res_2_d,cpu.res_2_e,cpu.res_2_h,cpu.res_2_l,cpu.res_2_hl,cpu.res_2_a,cpu.res_3_b,cpu.res_3_c,cpu.res_3_d,cpu.res_3_e,cpu.res_3_h,cpu.res_3_l,cpu.res_3_hl,cpu.res_3_a,cpu.res_4_b,cpu.res_4_c,cpu.res_4_d,cpu.res_4_e,cpu.res_4_h,cpu.res_4_l,cpu.res_4_hl,cpu.res_4_a,cpu.res_5_b,cpu.res_5_c,cpu.res_5_d,cpu.res_5_e,cpu.res_5_h,cpu.res_5_l,cpu.res_5_hl,cpu.res_5_a,cpu.res_6_b,cpu.res_6_c,cpu.res_6_d,cpu.res_6_e,cpu.res_6_h,cpu.res_6_l,cpu.res_6_hl,cpu.res_6_a,cpu.res_7_b,cpu.res_7_c,cpu.res_7_d,cpu.res_7_e,cpu.res_7_h,cpu.res_7_l,cpu.res_7_hl,cpu.res_7_a,cpu.set_0_b,cpu.set_0_c,cpu.set_0_d,cpu.set_0_e,cpu.set_0_h,cpu.set_0_l,cpu.set_0_hl,cpu.set_0_a,cpu.set_1_b,cpu.set_1_c,cpu.set_1_d,cpu.set_1_e,cpu.set_1_h,cpu.set_1_l,cpu.set_1_hl,cpu.set_1_a,cpu.set_2_b,cpu.set_2_c,cpu.set_2_d,cpu.set_2_e,cpu.set_2_h,cpu.set_2_l,cpu.set_2_hl,cpu.set_2_a,cpu.set_3_b,cpu.set_3_c,cpu.set_3_d,cpu.set_3_e,cpu.set_3_h,cpu.set_3_l,cpu.set_3_hl,cpu.set_3_a,cpu.set_4_b,cpu.set_4_c,cpu.set_4_d,cpu.set_4_e,cpu.set_4_h,cpu.set_4_l,cpu.set_4_hl,cpu.set_4_a,cpu.set_5_b,cpu.set_5_c,cpu.set_5_d,cpu.set_5_e,cpu.set_5_h,cpu.set_5_l,cpu.set_5_hl,cpu.set_5_a,cpu.set_6_b,cpu.set_6_c,cpu.set_6_d,cpu.set_6_e,cpu.set_6_h,cpu.set_6_l,cpu.set_6_hl,cpu.set_6_a,cpu.set_7_b,cpu.set_7_c,cpu.set_7_d,cpu.set_7_e,cpu.set_7_h,cpu.set_7_l,cpu.set_7_hl,cpu.set_7_a],memory={mbc:0,memdebug:0,readByte:function(c){switch(memory.mbc){case 0:return MBC0.readByte(c);case 1:return MBC1.readByte(c)}},readWord:function(c){switch(memory.mbc){case 0:return MBC0.readWord(c);case 1:return MBC1.readWord(c)}},writeByte:function(c,p){switch(memory.mbc){case 0:MBC0.writeByte(c,p);break;case 1:MBC1.writeByte(c,p)}},writeWord:function(c,p){switch(memory.mbc){case 0:MBC0.writeWord(c,p);break;case 1:MBC1.writeWord(c,p)}},loadROM:function(){var c=document.getElementById("romFileInput"),p=c.files[0];if(void 0===p)alert("Please Select a File");else{var u=document.getElementById("middle-content"),e=document.getElementById("footer");console.log(u),console.log(e),e.style.position="fixed",e.style.bottom=0;var t="-"+u.clientHeight.toString()+"px";console.log("mc height is",t),u.style.top=t;var a=new FileReader;a.onload=function(c){var p=new Uint8Array(a.result);switch(p[327]){case 0:console.log("no mbc"),MBC0.init(p);break;case 1:case 2:case 3:console.log("mbc1"),MBC1.init(p);break;default:return void alert("file not supported")}u.addEventListener("transitionend",emulator.runGame)},c.style.display="none",document.getElementById("load-ROM").style.display="none",a.readAsArrayBuffer(p)}},memoryInit:function(){for(c=256;c<65536;c++)MEMORY[c]=0;for(var c=256;c<32768;c++)ramBanks[Math.floor(c/8192)][c%8192]=0},oamDMATransfer:function(c){c<<=8;for(var p=0;p<160;p++)MEMORY[65024+p]=MEMORY[c+p]},biosInit:function(){cpu.a=1,cpu.c=19,cpu.e=216,cpu.h=1,cpu.l=20,cpu.f=176,cpu.sp=65534,cpu.pc=256,memory.writeByte(255,65280),memory.writeByte(225,65295),memory.writeByte(128,65296),memory.writeByte(191,65297),memory.writeByte(243,65298),memory.writeByte(191,65300),memory.writeByte(63,65302),memory.writeByte(191,65305),memory.writeByte(127,65306),memory.writeByte(255,65307),memory.writeByte(159,65308),memory.writeByte(191,65310),memory.writeByte(255,65312),memory.writeByte(191,65315),memory.writeByte(119,65316),memory.writeByte(243,65317),memory.writeByte(241,65318),memory.writeByte(145,65344),memory.writeByte(252,65351),memory.writeByte(255,65352),memory.writeByte(255,65353),console.log("bios initialized")},showStack:function(){console.log("STACK:");for(var c=0;255!=(cpu.sp+c&255);)console.log((cpu.sp+c).toString(16),": ",memory.readByte(cpu.sp+c)),c+=2}},MEMORY=[],display={mode:2,tCount:0,scrollY:0,scrollX:0,line:0,windowX:0,windowY:0,windowOn:0,windowMap:0,modeIntCalled:[0,0,0],vBintCalled:0,spriteSize:1,graphicsDebug:0,step:function(){switch(display.tCount+=cpu.t,display.line===MEMORY[65349]&&64==(64&MEMORY[65345])?(MEMORY[65295]|=2,MEMORY[65345]|=4):(MEMORY[65295]&=253,MEMORY[65345]&=251),display.mode){case 0:0===display.modeIntCalled[0]&&8&MEMORY[65345]&&(MEMORY[65295]|=2,display.modeIntCalled[0]=1),display.tCount>=204&&(display.tCount=0,display.mode=2,MEMORY[65345]&=252,MEMORY[65345]|=2,display.line>143&&(display.drawSprites(),display.mode=1,MEMORY[65345]&=252,MEMORY[65345]|=1,screen.putImageData(pixData,0,0)));break;case 1:0===display.vBIntCalled&&(MEMORY[65295]|=1,display.vBIntCalled=1),0===display.modeIntCalled[1]&&16&MEMORY[65345]&&(MEMORY[65295]|=2,display.modeIntCalled[1]=1),display.modeIntCalled[0]=0,display.tCount>=456&&(display.tCount=0,++display.line>153&&(display.mode=2,MEMORY[65345]&=252,MEMORY[65345]|=2,display.line=0));break;case 2:0===display.modeIntCalled[2]&&32&MEMORY[65345]&&(MEMORY[65295]|=2,display.modeIntCalled[2]=1),display.modeIntCalled[0]=0,display.modeIntCalled[1]=0,display.vBIntCalled=0,display.tCount>=80&&(display.tCount=0,display.mode=3,MEMORY[65345]&=252,MEMORY[65345]|=3);break;case 3:display.modeIntCalled[2]=0,display.tCount>=172&&(display.tCount=0,display.mode=0,MEMORY[65345]&=252,display.drawScanline(),display.line++)}},showState:function(){console.log("gpu mode: ",display.mode),console.log("tCount: ",display.tCount),console.log("LCD Control (FF40): ",MEMORY[65344].toString(16)),console.log("LCD STAT (FF41): ",MEMORY[65345].toString(16)),console.log("scrollY: (FF42)",display.scrollY.toString(16)),console.log("scrollX: (FF43)",display.scrollX.toString(16)),console.log("line: (FF44)",display.line.toString(16)),console.log("LYC: (FF45)",MEMORY[65349].toString(16)),console.log("BG Pal(FF47): ",MEMORY[65351].toString(16))},drawScanline:function(){var c=640*display.line;display.windowOn&&display.line>=display.windowY?display.drawWindowLine(c):display.drawBgLine(c)},drawBgLine:function(c){for(var p=(display.scrollY+display.line)%8*2,u=0;u<160;u++){var e=(display.scrollX+u)%8,t=Math.floor((display.scrollY+display.line)/8)%32,a=Math.floor((display.scrollX+u)/8)%32,r=8&MEMORY[65344]?tileMap1[t][a]:tileMap0[t][a];0==(16&MEMORY[65344])&&(r=cpu.signDecode(r)+128),r*=16;var l=16&MEMORY[65344]?tileSet1[r+p]:tileSet0[r+p],s=(16&MEMORY[65344]?tileSet1[r+p+1]:tileSet0[r+p+1])>>7-e&1?2:0;s+=l>>7-e&1?1:0,pixData.data[c]=paletteRef[s],pixData.data[c+1]=paletteRef[s],pixData.data[c+2]=paletteRef[s],c+=4}},drawWindowLine:function(c){for(var p=(display.scrollY+display.line)%8*2,u=0;u<display.windowX-7;u++){var e=(display.scrollX+u)%8,t=Math.floor((display.scrollY+display.line)/8)%32,a=Math.floor((display.scrollX+u)/8)%32,r=128==(8&MEMORY[65344])?tileMap1[t][a]:tileMap0[t][a];0==(16&MEMORY[65344])&&(r=cpu.signDecode(r)+128),r*=16;var l=16==(16&MEMORY[65344])?tileSet1[r+p]:tileSet0[r+p],s=(o=16==(16&MEMORY[65344])?tileSet1[r+p+1]:tileSet0[r+p+1])>>7-e&1?2:0;s+=l>>7-e&1?1:0,pixData.data[c]=paletteRef[s],pixData.data[c+1]=paletteRef[s],pixData.data[c+2]=paletteRef[s],c+=4}p=(display.line-display.windowY)%8*2;for(u=display.windowX-7;u<160;u++){(e=display.windowX-7)<0&&(e*=-1),e=(e+u)%8;var t=Math.floor((display.line-display.windowY)/8)%32,a=Math.floor((u-display.windowX+7)/8)%32,r=display.windowMap?tileMap1[t][a]:tileMap0[t][a];if((r*=16)>2032)var l=tileSet1[r+p],o=tileSet1[r+p+1];else var l=tileSet0[r+p+2048],o=tileSet0[r+p+2049];s=o>>7-e&1?2:0;s+=l>>7-e&1?1:0,pixData.data[c]=paletteRef[s],pixData.data[c+1]=paletteRef[s],pixData.data[c+2]=paletteRef[s],c+=4}},drawSprites:function(){for(var c=65180,p=0;p<40;p++){display.graphicsDebug&&console.log("sprite",40-p);var u=MEMORY[c+3];switch(u=u>>5&3){case 0:display.drawSprite(c);break;case 1:display.drawXFlipSprite(c);break;case 2:display.drawYFlipSprite(c);break;case 3:display.drawXYFlipSprite(c)}c-=4}},drawSprite:function(c){if(0!==(MEMORY[c]||MEMORY[c+1]))for(var p=tileSet1.slice(16*MEMORY[c+2],16*MEMORY[c+2]+16*display.spriteSize),u=MEMORY[c]-16,e=MEMORY[c+3]>>4&1,t=0;t<8*display.spriteSize;t++){if(display.lineOnScreen(MEMORY[c]-16,t))for(var a=p.slice(2*t,2*t+2),r=640*u,l=0;l<8;l++)if(display.pixOnScreen(MEMORY[c+1]-8,l)){var s=4*(MEMORY[c+1]-8+l),o=a[1]>>7-l&1?2:0;0===(o+=a[0]>>7-l&1?1:0)||(128&MEMORY[c+3]?display.pixelIs0(c,t,l)&&(pixData.data[r+s]=objPalettes[e][o],pixData.data[r+s+1]=objPalettes[e][o],pixData.data[r+s+2]=objPalettes[e][o]):(pixData.data[r+s]=objPalettes[e][o],pixData.data[r+s+1]=objPalettes[e][o],pixData.data[r+s+2]=objPalettes[e][o]))}u++}},drawXFlipSprite:function(c){if(0!==(MEMORY[c]||MEMORY[c+1]))for(var p=tileSet1.slice(16*MEMORY[c+2],16*MEMORY[c+2]+16*display.spriteSize),u=MEMORY[c]-16,e=MEMORY[c+3]>>4&1,t=0;t<8*display.spriteSize;t++){if(display.lineOnScreen(MEMORY[c]-16,t))for(var a=p.slice(2*t,2*t+2),r=640*u,l=0;l<8;l++)if(display.pixOnScreen(MEMORY[c+1]-8,l)){var s=4*(MEMORY[c+1]-8+l),o=a[1]>>l&1?2:0;0===(o+=a[0]>>l&1?1:0)||(128&MEMORY[c+3]?display.pixelIs0(c,t,l)&&(pixData.data[r+s]=objPalettes[e][o],pixData.data[r+s+1]=objPalettes[e][o],pixData.data[r+s+2]=objPalettes[e][o]):(pixData.data[r+s]=objPalettes[e][o],pixData.data[r+s+1]=objPalettes[e][o],pixData.data[r+s+2]=objPalettes[e][o]))}u++}},pixelIs0:function(c,p,u){var e=Math.floor((display.scrollY+MEMORY[c]+p-16)/8);e<0&&console.log(e);var t=Math.floor((display.scrollX+MEMORY[c+1]+u-8)/8),a=(display.scrollY+MEMORY[c]+p-16)%8,r=(display.scrollX+MEMORY[c+1]+u-8)%8,l=128==(8&MEMORY[65344])?tileMap1[e][t]:tileMap0[e][t];0==(16&MEMORY[65344])&&(l=cpu.signDecode(l)+128),l*=16;var s=16==(16&MEMORY[65344])?tileSet1[l+a]:tileSet0[l+a],o=(16==(16&MEMORY[65344])?tileSet1[l+a+1]:tileSet0[l+a+1])>>7-r&1?2:0;return 0===(o+=s>>7-r&1?1:0)},drawYFlipSprite:function(c){if(0!==(MEMORY[c]||MEMORY[c+1]))for(var p=tileSet1.slice(16*MEMORY[c+2],16*MEMORY[c+2]+16*display.spriteSize),u=MEMORY[c]-16,e=MEMORY[c+3]>>4&1,t=0;t<8*display.spriteSize;t++){if(display.lineOnScreen(MEMORY[c]-16,t))for(var a=p.slice(16*display.spriteSize-2*t,16*display.spriteSize-2*t+2),r=640*u,l=0;l<8;l++)if(display.pixOnScreen(MEMORY[c+1]-8,l)){var s=4*(MEMORY[c+1]-8+l),o=a[1]>>7-l&1?2:0;0===(o+=a[0]>>7-l&1?1:0)||(128&MEMORY[c+3]?display.pixelIs0(c,t,l)&&(pixData.data[r+s]=objPalettes[e][o],pixData.data[r+s+1]=objPalettes[e][o],pixData.data[r+s+2]=objPalettes[e][o]):(pixData.data[r+s]=objPalettes[e][o],pixData.data[r+s+1]=objPalettes[e][o],pixData.data[r+s+2]=objPalettes[e][o]))}u++}},drawXYFlipSprite:function(c){if(0!==(MEMORY[c]||MEMORY[c+1]))for(var p=tileSet1.slice(16*MEMORY[c+2],16*MEMORY[c+2]+16*display.spriteSize),u=MEMORY[c]-16,e=MEMORY[c+3]>>4&1,t=0;t<8*display.spriteSize;t++){if(display.lineOnScreen(MEMORY[c]-16,t))for(var a=p.slice(16*display.spriteSize-2*t,16*display.spriteSize-2*t+2),r=640*u,l=0;l<8;l++)if(display.pixOnScreen(MEMORY[c+1]-8,l)){var s=4*(MEMORY[c+1]-8+l),o=a[1]>>l&1?2:0;0===(o+=a[0]>>l&1?1:0)||(128&MEMORY[c+3]?display.pixelIs0(c,t,l)&&(pixData.data[r+s]=objPalettes[e][o],pixData.data[r+s+1]=objPalettes[e][o],pixData.data[r+s+2]=objPalettes[e][o]):(pixData.data[r+s]=objPalettes[e][o],pixData.data[r+s+1]=objPalettes[e][o],pixData.data[r+s+2]=objPalettes[e][o]))}u++}},canvasInit:function(){var c=document.getElementById("screen"),p=document.getElementById("screen-container"),u=p.clientHeight,e=p.clientWidth;console.log("canvasinit",u,e),e>=u?c.style.height="100%":c.style.width="100%",screen=c.getContext("2d"),pixData=screen.createImageData(160,144);for(t=0;t<pixData.data.length;t+=4)pixData.data[t]=0,pixData.data[t+1]=0,pixData.data[t+2]=0,pixData.data[t+3]=255;screen.putImageData(pixData,0,0);for(var t=0;t<20;t++)for(var a=0;a<16;a++)tileMap0[t][a]=0,tileMap1[t][a]=0,console.log("set a thing")},lineOnScreen:function(c,p){var u=c+p;return u<144&&u>=0},pixOnScreen:function(c,p){var u=c+p;return u<160&&u>0}},tileMap0=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],tileMap1=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],screen={},pixData={},spriteData=[],tileSet0=[],tileSet1=[],paletteRef=[255,192,96,0],objPalettes=[[],[]],input={keys:[255,255],keyDown:function(c){switch(MEMORY[65295]|=16,c.keyCode){case 65:input.keys[1]&=14;break;case 83:input.keys[1]&=13;break;case 38:input.keys[0]&=11;break;case 40:input.keys[0]&=7;break;case 37:input.keys[0]&=13;break;case 39:input.keys[0]&=14;break;case 13:input.keys[1]&=7;break;case 16:input.keys[1]&=11}},keyUp:function(c){switch(c.keyCode){case 65:input.keys[1]|=1;break;case 83:input.keys[1]|=2;break;case 38:input.keys[0]|=4;break;case 40:input.keys[0]|=8;break;case 37:input.keys[0]|=2;break;case 39:input.keys[0]|=1;break;case 13:input.keys[1]|=8;break;case 16:input.keys[1]|=4}}},interrupt={step:function(c){1&MEMORY[65535]&&1&MEMORY[65295]?interrupt.vBlankInt():2&MEMORY[65535]&&2&MEMORY[65295]?interrupt.lcdStatInt():4&MEMORY[65535]&&4&MEMORY[65295]?interrupt.timerInt():8&MEMORY[65535]&&8&MEMORY[65295]?interrupt.serialInt():16&MEMORY[65535]&&16&MEMORY[65295]&&interrupt.joypadInt()},vBlankInt:function(){1===cpu.ime&&(cpu.sp-=2,memory.writeWord(cpu.pc,cpu.sp),cpu.pc=64,cpu.ime=0,MEMORY[65295]&=254,cpu.t=20,timer.step(),display.step())},lcdStatInt:function(){1===cpu.ime&&(cpu.sp-=2,memory.writeWord(cpu.pc,cpu.sp),cpu.pc=72,cpu.ime=0,MEMORY[65295]&=253,cpu.t=20,timer.step(),display.step())},timerInt:function(){1===cpu.ime&&(cpu.sp-=2,memory.writeWord(cpu.pc,cpu.sp),cpu.pc=80,cpu.ime=0,MEMORY[65295]&=251,cpu.t=20,timer.step(),display.step())},serialInt:function(){1===cpu.ime&&(cpu.sp-=2,memory.writeWord(cpu.pc,cpu.sp),cpu.pc=88,cpu.ime=0,MEMORY[65295]&=247,cpu.t=20,timer.step(),display.step())},joypadInt:function(){1===cpu.ime&&(cpu.sp-=2,memory.writeWord(cpu.pc+1,cpu.sp),cpu.pc=96,cpu.ime=0,MEMORY[65295]&=239,cpu.t=20,timer.step(),display.step())}},MBC0={readByte:function(c){switch(61440&c){case 32768:case 36864:if(c>=32768&&c<36864)return tileSet1[c-32768];if(c>=36864&&c<38912)return tileSet0[c-34816];if(c>=38912&&c<39936)return c-=38912,tileMap0[Math.floor(c/32)][c%32];if(c>=39936&&c<40960)return c-=39936,tileMap1[Math.floor(c/32)][c%32];break;case 61440:switch(65280&c){case 65280:switch(c){case 65346:return display.scrollY;case 65347:return display.scrollX;case 65348:return display.line;default:return MEMORY[c]}case 65024:return c>=65024&&c<65184?spriteData[c-65024]:MEMORY[c];default:return MEMORY[c]}default:return MEMORY[c]}},readWord:function(c){var p=memory.readByte(c+1);return p<<=8,p|=memory.readByte(c)},writeByte:function(c,p){switch(61440&p){case 0:case 4096:case 8192:case 12288:case 16384:case 20480:case 24576:case 28672:break;case 32768:case 36864:p>=32768&&p<34816?tileSet1[p-32768]=c:p>=34816&&p<36864?(tileSet1[p-32768]=c,tileSet0[p-34816]=c):p>=36864&&p<38912?tileSet0[p-34816]=c:p>=38912&&p<39936?(p-=38912,tileMap0[Math.floor(p/32)][p%32]=c):p>=39936&&p<40960&&(p-=39936,tileMap1[Math.floor(p/32)][p%32]=c);break;case 61440:switch(65280&p){case 65280:switch(p){case 65280:MEMORY[65280]|=255,MEMORY[65280]&=207|c,16&c||(MEMORY[65280]&=input.keys[0]),32&c||(MEMORY[65280]&=input.keys[1]),48==(48&c)&&(MEMORY[65280]|=255);break;case 65284:MEMORY[p]=0;break;case 65285:MEMORY[p]=c;break;case 65287:MEMORY[p]=c,4&c&&(MEMORY[65285]=0),0==(3&c)?timer.timaSpeed=1024:1==(3&c)?timer.timaSpeed=16:2==(3&c)?timer.timaSpeed=64:3==(3&c)&&(timer.timaSpeed=256);break;case 65295:c|=224,MEMORY[p]=c;break;case 65344:MEMORY[p]=c,display.spriteSize=4&c?2:1,display.windowOn=32&c?1:0,display.windowMap=64&c?1:0;break;case 65346:display.scrollY=c;break;case 65347:display.scrollX=c;break;case 65348:display.line=c;break;case 65350:MEMORY[p]=c,memory.oamDMATransfer(c);break;case 65351:MEMORY[65351]=c;for(u=0;u<4;u++){switch(e=3&c){case 0:paletteRef[u]=255;break;case 1:paletteRef[u]=192;break;case 2:paletteRef[u]=96;break;case 3:paletteRef[u]=0}c>>=2}break;case 65352:MEMORY[65352]=c;for(u=0;u<4;u++){switch(e=3&c){case 0:objPalettes[0][u]=255;break;case 1:objPalettes[0][u]=192;break;case 2:objPalettes[0][u]=96;break;case 3:objPalettes[0][u]=0}c>>=2}break;case 65353:MEMORY[65353]=c;for(var u=0;u<4;u++){var e=3&c;switch(e){case 0:objPalettes[1][u]=255;break;case 1:objPalettes[1][u]=192;break;case 2:objPalettes[1][u]=96;break;case 3:objPalettes[1][u]=0}c>>=2}break;case 65354:display.windowY=c;break;case 65355:display.windowX=c;break;default:MEMORY[p]=c}break;default:MEMORY[p=c]}default:MEMORY[p]=c}},writeWord:function(c,p){var u=255&c;c>>=8,MBC0.writeByte(c,p+1),MBC0.writeByte(u,p)},init:function(c){memory.mbc=0;for(var p=0;p<32768;p++)MEMORY[p]=c[p]}},MBC1={mbcr1:0,mbcr2:1,mbcr3:0,mbcr4:0,readByte:function(c){switch(61440&c){case 16384:case 20480:case 24576:case 28672:return MBC1.mbcr4?romBanks[0][31&MBC1.mbcr2][c-16384]:romBanks[MBC1.mbcr3>>6][31&MBC1.mbcr2][c-16384];case 32768:case 36864:if(c>=32768&&c<36864)return tileSet1[c-32768];if(c>=36864&&c<38912)return tileSet0[c-34816];if(c>=38912&&c<39936)return c-=38912,tileMap0[Math.floor(c/32)][c%32];if(c>=39936&&c<40960)return c-=39936,tileMap1[Math.floor(c/32)][c%32];break;case 40960:case 45056:return 10===MBC1.mbcr4?ramBanks[3&MBC1.mbcr2][c-40960]:ramBanks[0][c-40960];case 61440:switch(65280&c){case 65280:switch(c){case 65346:return display.scrollY;case 65347:return display.scrollX;case 65348:return display.line;case 65354:return display.windowY;case 65355:return display.windowX;default:return MEMORY[c]}break;default:return MEMORY[c]}default:return MEMORY[c]}},readWord:function(c){var p=MBC1.readByte(c+1);return p<<=8,p|=MBC1.readByte(c)},writeByte:function(c,p){switch(61440&p){case 0:case 4096:MBC1.mbcr1=c;break;case 8192:case 12288:MBC1.mbcr2=c;break;case 16384:case 20480:0===c&&(c+=1),MBC1.mbcr3=c;break;case 24576:case 28672:MBC1.mbcr4=c;break;case 32768:case 36864:p>=32768&&p<34816?tileSet1[p-32768]=c:p>=34816&&p<36864?(tileSet1[p-32768]=c,tileSet0[p-34816]=c):p>=36864&&p<38912?tileSet0[p-34816]=c:p>=38912&&p<39936?(p-=38912,tileMap0[Math.floor(p/32)][p%32]=c):p>=39936&&p<40960&&(p-=39936,tileMap1[Math.floor(p/32)][p%32]=c);break;case 40960:case 45056:MBC1.mcbr4?ramBanks[3&MBC1.mbcr3][p-40960]=c:ramBanks[0][p-40960]=c;break;case 61440:switch(65280&p){case 65280:switch(p){case 65280:MEMORY[65280]|=255,MEMORY[65280]&=207|c,16&c||(MEMORY[65280]&=input.keys[0]),32&c||(MEMORY[65280]&=input.keys[1]),48==(48&c)&&(MEMORY[65280]|=255);break;case 65284:MEMORY[p]=0;break;case 65285:MEMORY[p]=c;break;case 65287:MEMORY[p]=c,4&c&&(MEMORY[65285]=0),0==(3&c)?timer.timaSpeed=1024:1==(3&c)?timer.timaSpeed=16:2==(3&c)?timer.timaSpeed=64:3==(3&c)&&(timer.timaSpeed=256);break;case 65295:c|=224,MEMORY[p]=c;break;case 65344:MEMORY[p]=c,display.spriteSize=4&c?2:1,display.windowOn=32&c?1:0,display.windowMap=64&c?1:0;break;case 65346:display.scrollY=c;break;case 65347:display.scrollX=c;break;case 65348:display.line=c;break;case 65350:MEMORY[p]=c,memory.oamDMATransfer(c);break;case 65351:MEMORY[65351]=c;for(u=0;u<4;u++){switch(e=3&c){case 0:paletteRef[u]=255;break;case 1:paletteRef[u]=192;break;case 2:paletteRef[u]=96;break;case 3:paletteRef[u]=0}c>>=2}break;case 65352:MEMORY[65352]=c;for(u=0;u<4;u++){switch(e=3&c){case 0:objPalettes[0][u]=255;break;case 1:objPalettes[0][u]=192;break;case 2:objPalettes[0][u]=96;break;case 3:objPalettes[0][u]=0}c>>=2}break;case 65353:MEMORY[65353]=c;for(var u=0;u<4;u++){var e=3&c;switch(e){case 0:objPalettes[1][u]=255;break;case 1:objPalettes[1][u]=192;break;case 2:objPalettes[1][u]=96;break;case 3:objPalettes[1][u]=0}c>>=2}break;case 65354:display.windowY=c;break;case 65355:display.windowX=c;break;default:MEMORY[p]=c}break;default:MEMORY[p]=c}break;default:MEMORY[p]=c}},writeWord:function(c,p){var u=255&c;c>>=8,MBC1.writeByte(c,p+1),MBC1.writeByte(u,p)},init:function(c){memory.mbc=1;for(var p=0;p<16384;p++)MEMORY[p]=c[p];for(p=0;p<4;p++)for(var u=0;u<31;u++)romBanks[p].push(new Array(16384));for(p=16384;p<c.length;p++)romBanks[Math.floor(p/524288)][Math.floor(p%524288/16384)][p%16384]=c[p]}},romBanks=[[[0]],[[0]],[[0]],[[0]]],ramBanks=[[0],[0],[0],[0]],timer={divCnt:0,timaCnt:0,timaSpeed:1024,timaOn:0,step:function(){if(timer.divCnt+=cpu.t,timer.timaOn&&(timer.timaCnt+=cpu.t),0!=(4&MEMORY[65287])?timer.timaOn=1:(timer.timaOn=0,timer.timaCnt=0),timer.divCnt>255&&(timer.divCnt=timer.divCnt%256,MEMORY[65284]+=1,MEMORY[65284]%=256),timer.timaCnt>timer.timaSpeed){var c=Math.floor(timer.timaCnt/timer.timaSpeed);timer.timaCnt=timer.timaCnt%timer.timaSpeed,MEMORY[65285]+=c,MEMORY[65285]>255&&(MEMORY[65295]|=4,MEMORY[65285]=MEMORY[65286])}}};